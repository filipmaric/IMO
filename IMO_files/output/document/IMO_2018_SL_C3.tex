%
\begin{isabellebody}%
\setisabellecontext{IMO{\isacharunderscore}{\isadigit{2}}{\isadigit{0}}{\isadigit{1}}{\isadigit{8}}{\isacharunderscore}SL{\isacharunderscore}C{\isadigit{3}}}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{IMO 2018 SL - C3%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ IMO{\isacharunderscore}{\isadigit{2}}{\isadigit{0}}{\isadigit{1}}{\isadigit{8}}{\isacharunderscore}SL{\isacharunderscore}C{\isadigit{3}}\isanewline
\ \ \isakeyword{imports}\ Complex{\isacharunderscore}Main\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{General lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ sum{\isacharunderscore}list{\isacharunderscore}int\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ xs\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ xs{\isachardot}\ int\ {\isacharparenleft}f\ x{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ int\ {\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ xs{\isachardot}\ f\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ xs{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sum{\isacharunderscore}list{\isacharunderscore}comp{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ xs{\isachardot}\ f\ {\isacharparenleft}g\ x{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ map\ g\ xs{\isachardot}\ f\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ xs{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lt{\isacharunderscore}ceiling{\isacharunderscore}frac{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharless}\ ceiling\ {\isacharparenleft}a\ {\isacharslash}\ b{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isacharasterisk}\ b\ {\isacharless}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ hide{\isacharunderscore}lams{\isacharparenright}\ floor{\isacharunderscore}less{\isacharunderscore}iff\ floor{\isacharunderscore}uminus{\isacharunderscore}of{\isacharunderscore}int\ less{\isacharunderscore}ceiling{\isacharunderscore}iff\ minus{\isacharunderscore}mult{\isacharunderscore}minus\ mult{\isacharunderscore}minus{\isacharunderscore}right\ of{\isacharunderscore}int{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}less{\isacharunderscore}iff\ of{\isacharunderscore}int{\isacharunderscore}minus\ of{\isacharunderscore}int{\isacharunderscore}mult\ pos{\isacharunderscore}less{\isacharunderscore}divide{\isacharunderscore}eq{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subset{\isacharunderscore}Max{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ X\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}Max\ X\ {\isacharplus}\ {\isadigit{1}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ X\ rule{\isacharcolon}\ finite{\isachardot}induct{\isacharparenright}\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ less{\isacharunderscore}Suc{\isacharunderscore}eq{\isacharunderscore}le\ subsetI{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}Max{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ X\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ X\ {\isasymle}\ Max\ X\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ subset{\isacharunderscore}Max{\isacharbrackleft}of\ X{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ subset{\isacharunderscore}eq{\isacharunderscore}atLeast{\isadigit{0}}{\isacharunderscore}lessThan{\isacharunderscore}card\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sum{\isacharunderscore}length{\isacharunderscore}parts{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymforall}\ i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isacharless}\ length\ ps\ {\isasymlongrightarrow}\ set\ {\isacharparenleft}filter\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ xs{\isacharparenright}\ {\isasyminter}\ set\ {\isacharparenleft}filter\ {\isacharparenleft}ps\ {\isacharbang}\ j{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sum{\isacharunderscore}list\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\ p{\isachardot}\ length\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}{\isacharparenright}\ ps{\isacharparenright}\ {\isasymle}\ length\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ ps\ arbitrary{\isacharcolon}\ xs{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ p\ ps{\isacharparenright}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}xs{\isacharprime}\ {\isacharequal}\ {\isachardoublequoteopen}filter\ {\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ {\isasymnot}\ p\ x{\isacharparenright}\ xs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}p{\isasymleftarrow}ps{\isachardot}\ length\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}p{\isasymleftarrow}ps{\isachardot}\ length\ {\isacharparenleft}filter\ p\ {\isacharquery}xs{\isacharprime}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ p{\isacharprime}\ {\isasymin}\ set\ ps{\isachardot}\ set\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}\ {\isasyminter}\ set\ {\isacharparenleft}filter\ p{\isacharprime}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ {\isadigit{0}}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}less{\isacharunderscore}eq\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ length{\isacharunderscore}Cons\ list{\isachardot}sel{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ nth{\isacharunderscore}Cons{\isacharunderscore}{\isadigit{0}}\ nth{\isacharunderscore}tl\ zero{\isacharunderscore}less{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ p\ {\isasymin}\ set\ ps{\isachardot}\ filter\ p\ xs\ {\isacharequal}\ filter\ p\ {\isacharquery}xs{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ p{\isacharprime}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isacharprime}\ {\isasymin}\ set\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}\ {\isasyminter}\ set\ {\isacharparenleft}filter\ p{\isacharprime}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ p{\isacharprime}\ xs\ {\isacharequal}\ filter\ p{\isacharprime}\ {\isacharquery}xs{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}subst\ filter{\isacharunderscore}filter{\isacharcomma}\ rule\ filter{\isacharunderscore}cong{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isacharprime}\ x\ {\isacharequal}\ {\isacharparenleft}{\isasymnot}\ p\ x\ {\isasymand}\ p{\isacharprime}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}set\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}\ {\isasyminter}\ set\ {\isacharparenleft}filter\ p{\isacharprime}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ p\ {\isasymin}\ set\ ps{\isachardot}\ length\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}\ {\isacharequal}\ length\ {\isacharparenleft}filter\ p\ {\isacharquery}xs{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ map{\isacharunderscore}eq{\isacharunderscore}conv{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}pa{\isasymleftarrow}ps{\isachardot}\ length\ {\isacharparenleft}filter\ pa\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymnot}\ p\ x{\isacharparenright}\ xs{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isasymle}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymnot}\ p\ x{\isacharparenright}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ Cons{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharcomma}\ safe{\isacharparenright}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\ j\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}\ j{\isachardoublequoteclose}\ {\isachardoublequoteopen}j\ {\isacharless}\ length\ ps{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}filter\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ {\isacharquery}xs{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}filter\ {\isacharparenleft}ps\ {\isacharbang}\ j{\isacharparenright}\ {\isacharquery}xs{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ {\isachardoublequoteopen}i{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}j{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}filter\ p\ xs{\isacharparenright}\ {\isacharplus}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ {\isasymnot}\ p\ x{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}length{\isacharunderscore}filter{\isacharunderscore}compl\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ hd{\isacharunderscore}filter{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}filter\ P\ xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ k{\isachardot}\ k\ {\isacharless}\ length\ xs\ {\isasymand}\ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ xs\ {\isacharbang}\ k\ {\isasymand}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}P\ x{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isachardoublequoteopen}k{\isacharless}length\ xs{\isachardoublequoteclose}\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ xs\ {\isacharbang}\ k{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}k{\isacharprime}{\isacharless}k{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ x{\isacharequal}{\isachardoublequoteopen}k{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}Cons{\isacharprime}{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ last{\isacharunderscore}filter{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}filter\ P\ xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ k{\isachardot}\ k\ {\isacharless}\ length\ xs\ {\isasymand}\ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}length\ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharbang}\ k\ {\isasymand}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ length\ xs\ {\isasymlongrightarrow}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ {\isacharparenleft}rev\ xs{\isacharparenright}\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Nil{\isacharunderscore}is{\isacharunderscore}rev{\isacharunderscore}conv\ rev{\isacharunderscore}filter{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}k\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\ {\isachardoublequoteopen}filter\ P\ {\isacharparenleft}rev\ xs{\isacharparenright}\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ rev\ xs\ {\isacharbang}\ k{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}rev\ xs\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}rev\ xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}filter{\isacharbrackleft}of\ P\ {\isachardoublequoteopen}rev\ xs{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ x{\isacharequal}{\isachardoublequoteopen}length\ xs\ {\isacharminus}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}\ safe{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ xs\ {\isacharminus}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isacharparenleft}length\ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharbang}\ {\isacharparenleft}length\ xs\ {\isacharminus}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ {\isacharasterisk}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ assms\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ rev{\isacharunderscore}filter\ rev{\isacharunderscore}nth{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ {\isacharparenleft}length\ xs\ {\isacharminus}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ {\isacharasterisk}{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ rev{\isacharunderscore}nth{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ k{\isacharprime}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ xs\ {\isacharminus}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ k{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ {\isacharasterisk}{\isacharparenleft}{\isadigit{4}}{\isacharparenright}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ {\isachardoublequoteopen}length\ xs\ {\isacharminus}\ {\isacharparenleft}k{\isacharprime}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ add{\isachardot}commute\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}right\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}right{\isacharprime}\ add{\isacharunderscore}diff{\isacharunderscore}inverse{\isacharunderscore}nat\ add{\isacharunderscore}gr{\isacharunderscore}{\isadigit{0}}\ diff{\isacharunderscore}less\ diff{\isacharunderscore}less{\isacharunderscore}mono{\isadigit{2}}\ not{\isacharunderscore}less{\isacharunderscore}eq\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ rev{\isacharunderscore}nth\ zero{\isacharunderscore}less{\isacharunderscore}one{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ \ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ filter{\isacharunderscore}tl\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}filter\ P\ {\isacharparenleft}tl\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ P\ {\isacharparenleft}hd\ xs{\isacharparenright}\ then\ tl\ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ else\ filter\ P\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ filter{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ filter{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ filter{\isacharunderscore}empty{\isacharunderscore}conv\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ hd{\isacharunderscore}in{\isacharunderscore}set\ list{\isachardot}inject\ list{\isachardot}sel{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ filter{\isacharunderscore}dropWhile{\isacharunderscore}not\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}filter\ P\ {\isacharparenleft}dropWhile\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymnot}\ P\ x{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ filter\ P\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ filter{\isacharunderscore}False\ filter{\isacharunderscore}append\ self{\isacharunderscore}append{\isacharunderscore}conv{\isadigit{2}}\ set{\isacharunderscore}takeWhileD\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inside{\isacharunderscore}filter{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}i\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ {\isacharparenleft}filter\ P\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ k{\isadigit{1}}\ k{\isadigit{2}}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}\ {\isasymand}\ k{\isadigit{2}}\ {\isacharless}\ length\ xs\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ {\isacharbang}\ i\ {\isacharequal}\ xs\ {\isacharbang}\ k{\isadigit{1}}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}filter\ P\ xs{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharbang}\ k{\isadigit{2}}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}\ {\isasymand}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}\ {\isasymlongrightarrow}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ i\ arbitrary{\isacharcolon}\ xs{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k{\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ xs\ {\isacharbang}\ k{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{1}}{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}filter\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ gr{\isacharunderscore}implies{\isacharunderscore}not{\isacharunderscore}zero\ length{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv{\isacharparenright}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}xs\ {\isacharequal}\ {\isachardoublequoteopen}drop\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ xs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ {\isacharparenleft}take\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ {\isacharparenleft}take\ k{\isadigit{1}}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{1}}{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ length\ xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ last{\isacharunderscore}filter\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}take\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ xs\ {\isacharequal}\ take\ k{\isadigit{1}}\ xs\ {\isacharat}\ {\isacharbrackleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ length\ xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ take{\isacharunderscore}Suc{\isacharunderscore}conv{\isacharunderscore}app{\isacharunderscore}nth\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ {\isacharquery}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ append{\isacharunderscore}take{\isacharunderscore}drop{\isacharunderscore}id\ filter{\isacharunderscore}append\ length{\isacharunderscore}Cons\ length{\isacharunderscore}append\ less{\isacharunderscore}not{\isacharunderscore}refl{\isadigit{3}}\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k{\isadigit{2}}{\isacharprime}\ \isakeyword{where}\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}k{\isadigit{2}}{\isacharprime}\ {\isacharless}\ length\ {\isacharquery}xs{\isachardoublequoteclose}\ {\isachardoublequoteopen}filter\ P\ {\isacharquery}xs\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ {\isacharquery}xs\ {\isacharbang}\ k{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isadigit{2}}{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}{\isacharprime}{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}filter{\isacharbrackleft}of\ P\ {\isacharquery}xs{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isadigit{1}}\ {\isacharequal}\ xs\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharplus}\ k{\isadigit{2}}{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacharbackquoteopen}filter\ P\ {\isacharparenleft}take\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharbrackright}{\isacharbackquoteclose}\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ length\ xs{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ Suc{\isacharunderscore}leI\ append{\isacharunderscore}take{\isacharunderscore}drop{\isacharunderscore}id\ filter{\isacharunderscore}append\ length{\isacharunderscore}Cons\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ nth{\isacharunderscore}append{\isacharunderscore}length{\isacharunderscore}plus\ nth{\isacharunderscore}drop\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharplus}\ k{\isadigit{2}}{\isacharprime}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ length\ xs{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharplus}\ k{\isadigit{2}}{\isacharprime}\ {\isasymlongrightarrow}\ {\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ k{\isacharprime}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharless}\ k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharplus}\ k{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ k{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ {\isacharparenleft}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}{\isacharprime}{\isachardot}\ {\isasymnot}\ P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{2}}{\isacharprime}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharplus}\ k{\isadigit{2}}{\isacharprime}\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{2}}{\isacharprime}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}filter\ P\ xs\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ x{\isacharequal}k{\isadigit{1}}\ \isakeyword{in}\ exI{\isacharcomma}\ rule{\isacharunderscore}tac\ x{\isacharequal}{\isachardoublequoteopen}k{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharplus}k{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}\ simp{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ i{\isacharparenright}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}t\ {\isacharequal}\ {\isachardoublequoteopen}takeWhile\ {\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ {\isasymnot}\ P\ x{\isacharparenright}\ xs{\isachardoublequoteclose}\ \isakeyword{and}\ {\isacharquery}d\ {\isacharequal}\ {\isachardoublequoteopen}dropWhile\ {\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ {\isasymnot}\ P\ x{\isacharparenright}\ xs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}xs\ {\isacharequal}\ {\isachardoublequoteopen}tl\ {\isacharquery}d{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ add{\isachardot}commute\ add{\isacharunderscore}less{\isacharunderscore}cancel{\isacharunderscore}left\ filter{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ filter{\isacharunderscore}dropWhile{\isacharunderscore}not\ filter{\isacharunderscore}tl\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ length{\isacharunderscore}Cons\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ not{\isacharunderscore}less{\isacharunderscore}zero{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isachardot}\ length\ {\isacharquery}t\ {\isacharplus}\ k\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ xs\ {\isasymlongrightarrow}\ xs\ {\isacharbang}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ tl\ {\isacharquery}d\ {\isacharbang}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ add{\isacharunderscore}lessD{\isadigit{1}}\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ length{\isacharunderscore}append\ less{\isacharunderscore}le\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ nth{\isacharunderscore}append{\isacharunderscore}length{\isacharunderscore}plus\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ {\isacharparenleft}filter\ P\ {\isacharquery}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k{\isadigit{1}}\ k{\isadigit{2}}\isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}filter\ P\ {\isacharquery}xs\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharquery}xs\ {\isacharbang}\ k{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}filter\ P\ {\isacharquery}xs\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ {\isacharquery}xs\ {\isacharbang}\ k{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}k{\isacharprime}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}\ {\isasymlongrightarrow}\ {\isasymnot}\ P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}of\ {\isacharquery}xs{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ x{\isacharequal}{\isachardoublequoteopen}k{\isadigit{1}}{\isacharplus}length\ {\isacharquery}t{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}\ rule{\isacharunderscore}tac\ x{\isacharequal}{\isachardoublequoteopen}k{\isadigit{2}}{\isacharplus}length\ {\isacharquery}t{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}\ safe{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{2}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ {\isacharquery}xs\ {\isacharplus}\ {\isadigit{1}}\ {\isacharplus}\ length\ {\isacharquery}t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{2}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ Suc{\isacharunderscore}pred\ add{\isachardot}commute\ add{\isacharunderscore}lessD{\isadigit{1}}\ length{\isacharunderscore}append\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ length{\isacharunderscore}tl\ less{\isacharunderscore}diff{\isacharunderscore}conv\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ add{\isachardot}commute\ add{\isacharunderscore}Suc{\isacharunderscore}right\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ length{\isacharunderscore}tl\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ not{\isacharunderscore}less{\isacharunderscore}zero\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ nth{\isacharunderscore}append{\isacharunderscore}length{\isacharunderscore}plus\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id\ zero{\isacharunderscore}less{\isacharunderscore}diff{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{2}}\ {\isacharplus}\ length\ {\isacharparenleft}takeWhile\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymnot}\ P\ x{\isacharparenright}\ xs{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ add{\isachardot}commute\ add{\isacharunderscore}Suc{\isacharunderscore}right\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ length{\isacharunderscore}tl\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ not{\isacharunderscore}less{\isacharunderscore}zero\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ nth{\isacharunderscore}append{\isacharunderscore}length{\isacharunderscore}plus\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id\ zero{\isacharunderscore}less{\isacharunderscore}diff{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ k{\isacharprime}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ k{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ k{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ linarith{\isacharplus}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharquery}t\ {\isacharplus}\ {\isacharparenleft}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharparenleft}tl\ {\isacharparenleft}dropWhile\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymnot}\ P\ x{\isacharparenright}\ xs{\isacharparenright}{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ \ ab{\isacharunderscore}semigroup{\isacharunderscore}add{\isacharunderscore}class{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ add{\isachardot}commute\ add{\isacharunderscore}lessD{\isadigit{1}}\ add{\isacharunderscore}less{\isacharunderscore}cancel{\isacharunderscore}left\ calculation{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ length{\isacharunderscore}append\ length{\isacharunderscore}tl\ less{\isacharunderscore}diff{\isacharunderscore}conv\ less{\isacharunderscore}trans{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ {\isacharparenleft}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}{\isacharbrackright}\ {\isacharbackquoteopen}P\ {\isacharparenleft}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ add{\isacharunderscore}Suc\ add{\isacharunderscore}diff{\isacharunderscore}inverse{\isacharunderscore}nat\ calculation{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ nat{\isacharunderscore}diff{\isacharunderscore}split\ not{\isacharunderscore}less{\isacharunderscore}zero{\isacharparenright}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}k{\isacharprime}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}\ {\isasymlongrightarrow}\ {\isasymnot}\ P\ {\isacharparenleft}{\isacharquery}xs\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharminus}\ {\isacharparenleft}length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}{\isacharbrackright}\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isacharparenleft}Suc\ i{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isacharparenleft}Suc\ i{\isacharparenright}\ {\isacharequal}\ filter\ P\ {\isacharquery}d\ {\isacharbang}\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ filter\ P\ {\isacharparenleft}tl\ {\isacharquery}d{\isacharparenright}\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\ {\isacartoucheopen}i\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ {\isacharparenleft}filter\ P\ {\isacharquery}xs{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ \ add{\isacharunderscore}lessD{\isadigit{1}}\ filter{\isacharunderscore}tl\ hd{\isacharunderscore}dropWhile\ list{\isachardot}sel{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}filter\ P\ {\isacharquery}xs\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharquery}xs\ {\isacharbang}\ k{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacartoucheclose}\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacartoucheclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ add{\isachardot}commute\ add{\isacharunderscore}Suc{\isacharunderscore}right\ add{\isacharunderscore}lessD{\isadigit{1}}\ add{\isacharunderscore}less{\isacharunderscore}cancel{\isacharunderscore}left\ length{\isacharunderscore}append\ length{\isacharunderscore}tl\ less{\isacharunderscore}diff{\isacharunderscore}conv\ less{\isacharunderscore}trans{\isacharunderscore}Suc\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isacharparenleft}Suc\ i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{2}}\ {\isacharplus}\ length\ {\isacharquery}t\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ P\ xs\ {\isacharbang}\ {\isacharparenleft}Suc\ i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ filter\ P\ {\isacharquery}d\ {\isacharbang}\ {\isacharparenleft}Suc\ i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ filter\ P\ {\isacharparenleft}tl\ {\isacharquery}d{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\ {\isacartoucheopen}i\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ {\isacharparenleft}filter\ P\ {\isacharquery}xs{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ add{\isachardot}commute\ filter{\isacharunderscore}tl\ hd{\isacharunderscore}dropWhile\ nth{\isacharunderscore}tl\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ tl{\isacharunderscore}Nil{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}filter\ P\ {\isacharquery}xs\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ {\isacharquery}xs\ {\isacharbang}\ k{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacartoucheclose}\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}xs{\isacartoucheclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ add{\isachardot}commute\ add{\isacharunderscore}Suc{\isacharunderscore}right\ add{\isacharunderscore}lessD{\isadigit{1}}\ add{\isacharunderscore}less{\isacharunderscore}cancel{\isacharunderscore}left\ length{\isacharunderscore}append\ length{\isacharunderscore}tl\ less{\isacharunderscore}diff{\isacharunderscore}conv\ less{\isacharunderscore}trans{\isacharunderscore}Suc\ takeWhile{\isacharunderscore}dropWhile{\isacharunderscore}id{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Unlabeled states%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ state\ {\isacharequal}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ initial{\isacharunderscore}state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ state{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}initial{\isacharunderscore}state\ n\ {\isacharequal}\ {\isacharparenleft}replicate\ {\isacharparenleft}n\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isadigit{0}}{\isacharparenright}\ {\isacharbrackleft}{\isadigit{0}}\ {\isacharcolon}{\isacharequal}\ n{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ final{\isacharunderscore}state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ state{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}final{\isacharunderscore}state\ n\ {\isacharequal}\ {\isacharparenleft}replicate\ {\isacharparenleft}n\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isadigit{0}}{\isacharparenright}\ {\isacharbrackleft}n\ {\isacharcolon}{\isacharequal}\ n{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ state\ {\isasymlongleftrightarrow}\ length\ state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}\ {\isasymand}\ sum{\isacharunderscore}list\ state\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ move\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ state\ {\isasymRightarrow}\ state{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}move\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ {\isacharequal}\ \isanewline
\ \ \ \ \ {\isacharparenleft}let\ k{\isadigit{1}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}{\isacharsemicolon}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ k{\isadigit{2}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ in\ state\ {\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ k{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ k{\isadigit{2}}\ {\isacharplus}\ {\isadigit{1}}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharprime}\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ \ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ state\ {\isasymRightarrow}\ state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}let\ k{\isadigit{1}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ in\ k{\isadigit{1}}\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}\ {\isasymand}\ p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ k{\isadigit{1}}\ {\isasymand}\ p{\isadigit{2}}\ {\isasymle}\ n\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ state{\isacharprime}\ {\isacharequal}\ move\ p{\isadigit{1}}\ p{\isadigit{2}}\ state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}move\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ state\ {\isasymRightarrow}\ state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ state\ state{\isacharprime}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\isasymexists}\ p{\isadigit{1}}\ p{\isadigit{2}}{\isachardot}\ valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}moves\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ states\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\isasymforall}\ i\ {\isacharless}\ length\ states\ {\isacharminus}\ {\isadigit{1}}{\isachardot}\ valid{\isacharunderscore}move\ n\ {\isacharparenleft}states\ {\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}states\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}game\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}game\ n\ states\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ length\ states\ {\isasymge}\ {\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ hd\ states\ {\isacharequal}\ initial{\isacharunderscore}state\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ last\ states\ {\isacharequal}\ final{\isacharunderscore}state\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ valid{\isacharunderscore}moves\ n\ states{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}initial{\isacharunderscore}state\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ {\isacharparenleft}initial{\isacharunderscore}state\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ initial{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}state{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}state{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ p{\isadigit{2}}\isanewline
\ \ \ \ \isakeyword{where}\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}state{\isacharprime}\ {\isacharequal}\ state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharplus}\ {\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ move{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sum{\isacharunderscore}list\ state\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ valid{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sum{\isacharunderscore}list\ {\isacharparenleft}state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharplus}\ {\isadigit{1}}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ sum{\isacharunderscore}list\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ assms\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}list{\isacharunderscore}update{\isacharbrackleft}of\ p{\isadigit{1}}\ state\ {\isachardoublequoteopen}state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}list{\isacharunderscore}update{\isacharbrackleft}of\ p{\isadigit{2}}\ {\isachardoublequoteopen}state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}state\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}state\ n\ state{\isacharbackquoteclose}\ {\isacharasterisk}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ valid{\isacharunderscore}state{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharunderscore}Nil\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharunderscore}Single\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharbrackleft}state{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharunderscore}Cons\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}state{\isadigit{1}}\ {\isacharhash}\ state{\isadigit{2}}\ {\isacharhash}\ states{\isacharparenright}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ valid{\isacharunderscore}move\ n\ state{\isadigit{1}}\ state{\isadigit{2}}\ {\isasymand}\ valid{\isacharunderscore}moves\ n\ {\isacharparenleft}state{\isadigit{2}}\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}Cons\ split{\isacharcolon}\ nat{\isachardot}split{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}states{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ states{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ state\ {\isasymin}\ set\ states{\isachardot}\ valid{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ states{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ states{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ list{\isachardot}sel{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ list{\isachardot}set{\isacharunderscore}cases\ set{\isacharunderscore}ConsD\ valid{\isacharunderscore}moves{\isacharunderscore}Cons\ valid{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}state{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}game{\isacharunderscore}valid{\isacharunderscore}states{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}game\ n\ states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ state\ {\isasymin}\ set\ states{\isachardot}\ valid{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}game{\isacharunderscore}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}states\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ move{\isacharunderscore}positions\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}move{\isacharunderscore}positions\ state\ state{\isacharprime}\ {\isacharequal}\ \isanewline
\ \ \ \ {\isacharparenleft}THE\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}{\isachardot}\ valid{\isacharunderscore}move{\isacharprime}\ {\isacharparenleft}length\ state\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ move{\isacharunderscore}positions{\isacharunderscore}unique{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}{\isachardot}\ valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ p{\isadigit{1}}{\isachardot}\ p{\isadigit{1}}\ {\isacharless}\ length\ state\ {\isasymand}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ move{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}left{\isacharprime}\ le{\isacharunderscore}SucI\ less{\isacharunderscore}imp{\isacharunderscore}Suc{\isacharunderscore}add\ less{\isacharunderscore}le{\isacharunderscore}trans\ list{\isacharunderscore}update{\isacharunderscore}swap\ n{\isacharunderscore}not{\isacharunderscore}Suc{\isacharunderscore}n\ nat{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}eq\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}neq\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ p{\isadigit{1}}{\isachardot}\ p{\isadigit{1}}\ {\isasymle}\ n\ {\isasymand}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Nat{\isachardot}le{\isacharunderscore}diff{\isacharunderscore}conv{\isadigit{2}}\ Suc{\isacharunderscore}leI\ add{\isachardot}commute\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}right{\isacharprime}\ le{\isacharunderscore}add{\isadigit{2}}\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ p{\isadigit{2}}{\isachardot}\ p{\isadigit{2}}\ {\isacharless}\ length\ state\ {\isasymand}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ move{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ diff{\isacharunderscore}le{\isacharunderscore}self\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ length{\isacharunderscore}list{\isacharunderscore}update\ n{\isacharunderscore}not{\isacharunderscore}Suc{\isacharunderscore}n\ nat{\isacharunderscore}neq{\isacharunderscore}iff\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}eq\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}neq\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ p{\isadigit{2}}{\isachardot}\ p{\isadigit{2}}\ {\isasymle}\ n\ {\isasymand}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharequal}\ state\ {\isacharbang}\ p{\isadigit{2}}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ discrete{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ p{\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}case\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}\ of\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}\ {\isasymRightarrow}\ valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}case\ x\ of\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharparenright}\ {\isasymRightarrow}\ valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isacharbackquoteclose}\ {\isacharasterisk}\ {\isacharasterisk}{\isacharasterisk}\ \ {\isacartoucheopen}length\ state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ move{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Nat{\isachardot}add{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}right\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isacharunderscore}Suc{\isacharunderscore}right\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ le{\isacharunderscore}less{\isacharunderscore}trans\ length{\isacharunderscore}list{\isacharunderscore}update\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ nat{\isacharunderscore}neq{\isacharunderscore}iff\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}eq\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}neq{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}move{\isacharunderscore}positions{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}THE\ x{\isachardot}\ let\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharparenright}\ {\isacharequal}\ x\ in\ valid{\isacharunderscore}move{\isacharprime}\ {\isacharparenleft}length\ state\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ state\ state{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ the{\isacharunderscore}equality{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}let\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}\ in\ valid{\isacharunderscore}move{\isacharprime}\ {\isacharparenleft}length\ state\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}let\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharparenright}\ {\isacharequal}\ x\ in\ valid{\isacharunderscore}move{\isacharprime}\ {\isacharparenleft}length\ state\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ move{\isacharunderscore}positions{\isacharunderscore}unique{\isacharbrackleft}of\ n\ state\ state{\isacharprime}{\isacharbrackright}\ assms\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ move{\isacharunderscore}positions{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ fstI\ sndI\ valid{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}move{\isacharunderscore}positions{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Labeled states%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ labeled{\isacharunderscore}state\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}nat\ set{\isacharparenright}\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ initial{\isacharunderscore}labeled{\isacharunderscore}state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ labeled{\isacharunderscore}state{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n\ \ {\isacharequal}\ {\isacharparenleft}replicate\ {\isacharparenleft}n{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isacharbraceleft}{\isacharbraceright}{\isacharparenright}\ {\isacharbrackleft}{\isadigit{0}}\ {\isacharcolon}{\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ final{\isacharunderscore}labeled{\isacharunderscore}state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ labeled{\isacharunderscore}state{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}final{\isacharunderscore}labeled{\isacharunderscore}state\ n\ \ {\isacharequal}\ {\isacharparenleft}replicate\ {\isacharparenleft}n{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isacharbraceleft}{\isacharbraceright}{\isacharparenright}\ {\isacharbrackleft}n\ {\isacharcolon}{\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ length\ l{\isacharunderscore}state\ {\isacharequal}\ n{\isacharplus}{\isadigit{1}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymforall}\ i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharparenright}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ labeled{\isacharunderscore}move\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}labeled{\isacharunderscore}move\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ {\isacharequal}\ \isanewline
\ \ \ \ {\isacharparenleft}let\ ss{\isadigit{1}}\ {\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ ss{\isadigit{2}}\ {\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}\ \isanewline
\ \ \ \ \ \ in\ l{\isacharunderscore}state\ {\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ ss{\isadigit{1}}\ {\isacharminus}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ ss{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}let\ ss{\isadigit{1}}\ {\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ in\ p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}\ {\isasymand}\ p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ card\ ss{\isadigit{1}}\ {\isasymand}\ p{\isadigit{2}}\ {\isasymle}\ n\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ stone\ {\isasymin}\ ss{\isadigit{1}}\ {\isasymand}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ labeled{\isacharunderscore}move\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\isasymexists}\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymforall}\ i\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game\ n\ l{\isacharunderscore}states\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ hd\ l{\isacharunderscore}states\ {\isacharequal}\ initial{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ last\ l{\isacharunderscore}states\ {\isacharequal}\ final{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}initial{\isacharunderscore}labeled{\isacharunderscore}state\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ initial{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}final{\isacharunderscore}labeled{\isacharunderscore}state\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}final{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}replicate\ {\isacharparenleft}Suc\ n{\isacharparenright}\ {\isacharbraceleft}{\isacharbraceright}{\isacharparenright}{\isacharbrackleft}n\ {\isacharcolon}{\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isacharbrackright}\ {\isacharequal}\ {\isacharparenleft}replicate\ n\ {\isacharbraceleft}{\isacharbraceright}{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}{\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ length{\isacharunderscore}replicate\ list{\isacharunderscore}update{\isacharunderscore}length\ replicate{\isacharunderscore}Suc\ replicate{\isacharunderscore}append{\isacharunderscore}same{\isacharparenright}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ del{\isacharcolon}\ replicate{\isacharunderscore}Suc\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}append{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ \isakeyword{where}\ \isanewline
\ \ \ \ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ l{\isacharunderscore}state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ Let{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ i\ {\isasymle}\ n{\isachardot}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharparenleft}if\ i\ {\isacharequal}\ p{\isadigit{1}}\ then\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isacharbraceleft}stone{\isacharbraceright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ if\ i\ {\isacharequal}\ p{\isadigit{2}}\ then\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}stone{\isacharbraceright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone\ {\isasymnotin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharbackquoteclose}\ \ {\isacharbackquoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Collect{\isacharunderscore}mem{\isacharunderscore}eq\ IntI\ empty{\isacharunderscore}Collect{\isacharunderscore}eq{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ i\ {\isasymle}\ n{\isachardot}\ i\ {\isasymnoteq}\ p{\isadigit{1}}\ {\isasymlongrightarrow}\ stone\ {\isasymnotin}\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharbackquoteclose}\ \ {\isacharbackquoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ disjoint{\isacharunderscore}iff{\isacharunderscore}not{\isacharunderscore}equal\ le{\isacharunderscore}less{\isacharunderscore}trans\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ nat{\isacharunderscore}neq{\isacharunderscore}iff{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ X\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}X\ {\isasymin}\ set\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ i{\isachardoublequoteclose}\ {\isachardoublequoteopen}i\ {\isasymle}\ n{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ n{\isacharplus}{\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ le{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacharbackquoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Diff{\isacharunderscore}iff\ One{\isacharunderscore}nat{\isacharunderscore}def\ Un{\isacharunderscore}insert{\isacharunderscore}right\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ boolean{\isacharunderscore}algebra{\isacharunderscore}cancel{\isachardot}sup{\isadigit{0}}\ insertE\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ le{\isacharunderscore}less{\isacharunderscore}trans\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ mem{\isacharunderscore}simps{\isacharparenleft}{\isadigit{9}}{\isacharparenright}\ nth{\isacharunderscore}mem{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ X\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}X\ {\isasymin}\ set\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ add{\isachardot}commute\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ le{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}i\ {\isacharequal}\ p{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ p{\isadigit{1}}\ {\isasymor}\ x\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\ {\isacharbackquoteopen}x\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharasterisk}{\isachardoublequoteclose}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ mem{\isacharunderscore}simps{\isacharparenleft}{\isadigit{9}}{\isacharparenright}\ nth{\isacharunderscore}mem\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\ {\isacharbackquoteopen}x\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}i\ {\isasymle}\ n{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isachardoublequoteopen}{\isacharasterisk}{\isachardoublequoteclose}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ Sup{\isacharunderscore}upper\ {\isacartoucheopen}i\ {\isasymle}\ n{\isacartoucheclose}\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ nth{\isacharunderscore}mem\ subsetD{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\ j\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharless}\ j{\isachardoublequoteclose}\ {\isachardoublequoteopen}j\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ i{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ j{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacharbackquoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}stone\ {\isasymnotin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}{\isasymforall}\ i\ {\isasymle}\ n{\isachardot}\ i\ {\isasymnoteq}\ p{\isadigit{1}}\ {\isasymlongrightarrow}\ stone\ {\isasymnotin}\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n{\isacharplus}{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ n{\isacharplus}{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}j\ {\isacharequal}\ p{\isadigit{2}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}smt\ Diff{\isacharunderscore}insert{\isacharunderscore}absorb\ Diff{\isacharunderscore}subset\ IntI\ Un{\isacharunderscore}insert{\isacharunderscore}right\ boolean{\isacharunderscore}algebra{\isacharunderscore}cancel{\isachardot}sup{\isadigit{0}}\ empty{\isacharunderscore}iff\ insertE\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ less{\isacharunderscore}le{\isacharunderscore}trans\ mk{\isacharunderscore}disjoint{\isacharunderscore}insert\ nat{\isacharunderscore}neq{\isacharunderscore}iff\ subsetD{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}smt\ Un{\isacharunderscore}insert{\isacharunderscore}right\ boolean{\isacharunderscore}algebra{\isacharunderscore}cancel{\isachardot}sup{\isadigit{0}}\ disjoint{\isacharunderscore}iff{\isacharunderscore}not{\isacharunderscore}equal\ insert{\isacharunderscore}Diff\ insert{\isacharunderscore}iff\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ less{\isacharunderscore}le{\isacharunderscore}trans{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\ Let{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ state\ {\isasymin}\ set\ l{\isacharunderscore}states{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ states{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ length{\isacharunderscore}tl\ less{\isacharunderscore}diff{\isacharunderscore}conv\ list{\isachardot}inject\ list{\isachardot}set{\isacharunderscore}cases\ list{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ nth{\isacharunderscore}Cons{\isacharunderscore}{\isadigit{0}}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game\ n\ states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ state\ {\isasymin}\ set\ states{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}THE\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ {\isacharparenleft}length\ state\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}unique{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ \isakeyword{where}\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}case\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ of\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ stone{\isacharprime}\ \isakeyword{where}\ x{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}case\ x\ of\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ stone{\isacharprime}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymin}\ state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymnotin}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}stone\ {\isasymnotin}\ state\ {\isacharbang}\ p{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymin}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}\ stone{\isacharprime}{\isacharprime}\ p{\isachardot}\ p\ {\isasymle}\ n\ {\isasymand}\ stone{\isacharprime}{\isacharprime}\ {\isacharless}\ n\ {\isasymand}\ stone{\isacharprime}{\isacharprime}\ {\isasymnoteq}\ stone\ {\isasymlongrightarrow}\ {\isacharparenleft}stone{\isacharprime}{\isacharprime}\ {\isasymin}\ state\ {\isacharbang}\ p\ {\isasymlongleftrightarrow}\ stone{\isacharprime}{\isacharprime}\ {\isasymin}\ state{\isacharprime}\ {\isacharbang}\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}p{\isadigit{1}}{\isacharprime}\ {\isacharless}\ p{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}{\isacharprime}\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isacharless}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymin}\ state\ {\isacharbang}\ p{\isadigit{1}}{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymnotin}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{1}}{\isacharprime}{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymnotin}\ state\ {\isacharbang}\ p{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymin}\ state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}\ stone{\isacharprime}{\isacharprime}\ p{\isachardot}\ p\ {\isasymle}\ n\ {\isasymand}\ stone{\isacharprime}{\isacharprime}\ {\isacharless}\ n\ {\isasymand}\ stone{\isacharprime}{\isacharprime}\ {\isasymnoteq}\ stone{\isacharprime}\ {\isasymlongrightarrow}\ {\isacharparenleft}stone{\isacharprime}{\isacharprime}\ {\isasymin}\ state\ {\isacharbang}\ p\ {\isasymlongleftrightarrow}\ stone{\isacharprime}{\isacharprime}\ {\isasymin}\ state{\isacharprime}\ {\isacharbang}\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone\ {\isacharequal}\ stone{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ disj{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ state\ {\isacharbang}\ i\ {\isasyminter}\ state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharequal}\ p{\isadigit{1}}{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ {\isacharbackquoteopen}stone\ {\isacharequal}\ stone{\isacharprime}{\isacharbackquoteclose}\ {\isacharasterisk}{\isacharparenleft}{\isadigit{1}}{\isacharminus}{\isadigit{2}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharparenleft}{\isadigit{1}}{\isacharminus}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ disj{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ p{\isadigit{1}}\ p{\isadigit{1}}{\isacharprime}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ disj{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{1}}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ disj{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ state{\isacharprime}\ {\isacharbang}\ i\ {\isasyminter}\ state{\isacharprime}\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isacharequal}\ p{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharparenleft}{\isadigit{7}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharparenleft}{\isadigit{7}}{\isacharparenright}\ {\isacharbackquoteopen}stone\ {\isacharequal}\ stone{\isacharprime}{\isacharbackquoteclose}\ {\isacharasterisk}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ disj{\isacharprime}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ p{\isadigit{2}}\ p{\isadigit{2}}{\isacharprime}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ disj{\isacharprime}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ p{\isadigit{2}}{\isacharprime}\ p{\isadigit{2}}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x\ {\isacharbackquoteopen}stone\ {\isacharequal}\ stone{\isacharprime}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharequal}\ p{\isadigit{1}}{\isacharprime}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isacharequal}\ p{\isadigit{2}}{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}unique{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharcomma}\ of\ state{\isacharprime}{\isacharbrackright}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto\ {\isacharparenleft}smt\ case{\isacharunderscore}prodI\ the{\isacharunderscore}equality{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ stone{\isacharunderscore}position\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}labeled{\isacharunderscore}state\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone\ {\isacharequal}\ \isanewline
\ \ \ \ \ {\isacharparenleft}THE\ k{\isachardot}\ k\ {\isacharless}\ length\ l{\isacharunderscore}state\ {\isasymand}\ stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stone{\isacharunderscore}position{\isacharunderscore}unique{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}\ k{\isachardot}\ k\ {\isacharless}\ length\ l{\isacharunderscore}state\ {\isasymand}\ stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ k{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone\ {\isasymin}\ {\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ UnionE\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k{\isacharprime}\ {\isacharless}\ length\ l{\isacharunderscore}state\ {\isasymand}\ stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ k{\isacharprime}\ {\isasymlongrightarrow}\ k\ {\isacharequal}\ k{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ IntI\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ empty{\isacharunderscore}iff\ le{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ nat{\isacharunderscore}neq{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stone{\isacharunderscore}position{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone\ {\isasymle}\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ {\isacharparenleft}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ stone{\isacharunderscore}position{\isacharunderscore}unique{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ theI{\isacharbrackleft}of\ {\isachardoublequoteopen}{\isasymlambda}\ k{\isachardot}\ k\ {\isacharless}\ length\ l{\isacharunderscore}state\ {\isasymand}\ stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ k{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ stone{\isacharunderscore}position{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ le{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stone{\isacharunderscore}positionI{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone\ {\isacharequal}\ k{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ stone{\isacharunderscore}position{\isacharunderscore}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ assms\ stone{\isacharunderscore}position{\isacharunderscore}unique\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone\ {\isacharequal}\ p{\isadigit{1}}\ {\isasymand}\ stone{\isacharunderscore}position\ l{\isacharunderscore}state{\isacharprime}\ stone\ {\isacharequal}\ p{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone\ {\isacharequal}\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ stone{\isacharunderscore}positionI{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharless}\ length\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state{\isacharprime}\ stone\ {\isacharequal}\ p{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ stone{\isacharunderscore}positionI{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isacharless}\ length\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions{\isacharunderscore}other{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ stone{\isacharprime}{\isachardot}\ stone{\isacharprime}\ {\isasymnoteq}\ stone\ {\isasymand}\ stone{\isacharprime}\ {\isacharless}\ n\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stone{\isacharunderscore}position\ l{\isacharunderscore}state{\isacharprime}\ stone{\isacharprime}\ {\isacharequal}\ stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ stone{\isacharprime}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isacharless}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymnoteq}\ stone{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state{\isacharprime}\ stone{\isacharprime}\ {\isacharequal}\ stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ stone{\isacharunderscore}positionI{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharprime}\ {\isacharless}\ length\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}stone{\isacharprime}\ {\isacharless}\ n{\isacartoucheclose}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharminus}{\isadigit{2}}{\isacharparenright}\ stone{\isacharunderscore}position{\isacharbrackleft}of\ n\ l{\isacharunderscore}state\ stone{\isacharprime}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ labeled{\isacharunderscore}move{\isacharunderscore}def\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ length{\isacharunderscore}list{\isacharunderscore}update\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymin}\ l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}stone{\isacharunderscore}position\ l{\isacharunderscore}state\ stone{\isacharprime}\ {\isacharless}\ length\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}stone{\isacharprime}\ {\isacharless}\ n{\isacartoucheclose}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharminus}{\isadigit{2}}{\isacharparenright}\ stone{\isacharunderscore}position{\isacharbrackleft}of\ n\ l{\isacharunderscore}state\ stone{\isacharprime}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone{\isacharprime}\ {\isasymnoteq}\ stone{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Un{\isacharunderscore}insert{\isacharunderscore}right\ boolean{\isacharunderscore}algebra{\isacharunderscore}cancel{\isachardot}sup{\isadigit{0}}\ insert{\isacharunderscore}Diff\ insert{\isacharunderscore}iff\ length{\isacharunderscore}list{\isacharunderscore}update\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}eq\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}neq{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Unlabel%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ unlabel\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}labeled{\isacharunderscore}state\ {\isasymRightarrow}\ state{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}unlabel\ {\isacharequal}\ map\ card{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unlabel{\isacharunderscore}initial\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}unlabel\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharequal}\ initial{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ initial{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ initial{\isacharunderscore}state{\isacharunderscore}def\ unlabel{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unlabel{\isacharunderscore}final\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}unlabel\ {\isacharparenleft}final{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharequal}\ final{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ final{\isacharunderscore}state{\isacharunderscore}def\ unlabel{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ card{\isacharunderscore}atLeastLessThan\ card{\isacharunderscore}empty\ diff{\isacharunderscore}zero\ map{\isacharunderscore}replicate\ map{\isacharunderscore}update{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unlabel{\isacharunderscore}valid{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}state{\isacharunderscore}def\ unlabel{\isacharunderscore}def\isanewline
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}state\ {\isacharequal}\ {\isachardoublequoteopen}map\ card\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharquery}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sum{\isacharunderscore}list\ {\isacharquery}state\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}s\ {\isacharequal}\ {\isachardoublequoteopen}filter\ {\isacharparenleft}{\isasymlambda}\ y{\isachardot}\ card\ y\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ l{\isacharunderscore}state{\isachardot}\ card\ x{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ {\isacharquery}s{\isachardot}\ card\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ sum{\isacharunderscore}list{\isacharunderscore}map{\isacharunderscore}filter{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ x\ {\isasymin}\ set\ {\isacharquery}s{\isachardot}\ card\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isacharless}\ length\ l{\isacharunderscore}state\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharquery}s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharunderscore}state{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ l{\isacharunderscore}state{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isacharless}\ length\ l{\isacharunderscore}state\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ Suc{\isacharunderscore}less{\isacharunderscore}eq\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}y{\isachardot}\ card\ y\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ a\ {\isachargreater}\ {\isadigit{0}}\ {\isasymlongrightarrow}\ a\ {\isasymnotin}\ set\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ a\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymin}\ set\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ {\isadigit{0}}{\isacharbrackright}\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}\ card\ a{\isacartoucheclose}\ {\isacartoucheopen}a\ {\isasymin}\ set\ l{\isacharunderscore}state{\isacartoucheclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ card{\isacharunderscore}empty\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ inf{\isachardot}idem\ le{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ length{\isacharunderscore}Cons\ not{\isacharunderscore}le\ nth{\isacharunderscore}Cons{\isacharunderscore}{\isadigit{0}}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ zero{\isacharunderscore}less{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}list{\isacharunderscore}distinct{\isacharunderscore}conv{\isacharunderscore}sum{\isacharunderscore}set\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ card\ {\isacharparenleft}{\isasymUnion}\ {\isacharparenleft}set\ {\isacharquery}s{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i{\isasymin}set\ {\isacharquery}s{\isachardot}\ finite\ {\isacharparenleft}id\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i{\isasymin}set\ {\isacharquery}s{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymforall}j{\isasymin}set\ {\isacharquery}s{\isachardot}\ i\ {\isasymnoteq}\ j\ {\isasymlongrightarrow}\ id\ i\ {\isasyminter}\ id\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ ballI{\isacharcomma}\ rule\ ballI{\isacharcomma}\ rule\ impI{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\ j\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isasymin}\ set\ {\isacharquery}s{\isachardoublequoteclose}\ {\isachardoublequoteopen}j\ {\isasymin}\ set\ {\isacharquery}s{\isachardoublequoteclose}\ {\isachardoublequoteopen}i\ {\isasymnoteq}\ j{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i{\isacharprime}\ j{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}j\ {\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ j{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}i{\isacharprime}\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}j{\isacharprime}\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ filter{\isacharunderscore}is{\isacharunderscore}subset\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ le{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ subsetD{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}id\ i\ {\isasyminter}\ id\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ {\isacharbackquoteopen}i\ {\isasymnoteq}\ j{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ disjoint{\isacharunderscore}iff{\isacharunderscore}not{\isacharunderscore}equal\ id{\isacharunderscore}apply\ nat{\isacharunderscore}neq{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}UN{\isacharunderscore}disjoint{\isacharbrackleft}of\ {\isachardoublequoteopen}set\ {\isacharquery}s{\isachardoublequoteclose}\ id{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\isasymUnion}\ {\isacharparenleft}set\ {\isacharquery}s{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ card\ {\isacharparenleft}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharparenleft}set\ {\isacharquery}s{\isacharparenright}\ {\isacharequal}\ {\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}\ {\isasymsubseteq}\ {\isasymUnion}\ {\isacharparenleft}set\ {\isacharquery}s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ X\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}X\ {\isasymin}\ set\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Union{\isacharunderscore}upper\ finite{\isacharunderscore}subset\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymUnion}\ {\isacharparenleft}set\ {\isacharquery}s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unlabel{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharprime}{\isacharparenright}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ unlabel\ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ move\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ l{\isacharunderscore}state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ unlabel{\isacharunderscore}def\ Let{\isacharunderscore}def\ labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isasymand}\ finite\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ Union{\isacharunderscore}upper\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ finite{\isacharunderscore}atLeastLessThan\ finite{\isacharunderscore}subset\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ le{\isacharunderscore}less{\isacharunderscore}trans\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ nth{\isacharunderscore}mem{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone\ {\isasymnotin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}{\isasymforall}i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isasymle}\ n\ {\isasymlongrightarrow}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isasyminter}\ l{\isacharunderscore}state\ {\isacharbang}\ j\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Collect{\isacharunderscore}empty{\isacharunderscore}eq\ Collect{\isacharunderscore}mem{\isacharunderscore}eq\ IntI{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ length\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}card\ {\isacharparenleft}l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}card\ {\isacharparenleft}l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ p{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}\ p{\isachardot}\ p\ {\isasymle}\ n\ {\isasymand}\ p\ {\isasymnoteq}\ p{\isadigit{1}}\ {\isasymand}\ p\ {\isasymnoteq}\ p{\isadigit{2}}\ {\isasymlongrightarrow}\ card\ {\isacharparenleft}l{\isacharunderscore}state{\isacharprime}\ {\isacharbang}\ p{\isacharparenright}\ {\isacharequal}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}finite\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isasymand}\ finite\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}stone\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone\ {\isasymnotin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ l{\isacharunderscore}state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}eq\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharminus}\ {\isacharparenleft}blast{\isacharcomma}\ simp{\isacharplus}{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p{\isadigit{2}}\ {\isasymle}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ l{\isacharunderscore}state{\isacharbrackleft}p{\isadigit{1}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}\ {\isacharminus}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharcomma}\ p{\isadigit{2}}\ {\isacharcolon}{\isacharequal}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}stone{\isacharbraceright}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ unlabel{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ move{\isacharunderscore}def\ map{\isacharunderscore}update{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unlabel{\isacharunderscore}valid{\isacharunderscore}move{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ unlabel{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackright}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Labeled move max stone%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ labeled{\isacharunderscore}state\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\isasymexists}\ p{\isadigit{1}}\ p{\isadigit{2}}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymforall}\ i\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ hd\ l{\isacharunderscore}states\ {\isacharequal}\ initial{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ last\ l{\isacharunderscore}states\ {\isacharequal}\ final{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}Cons{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ states{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone\ n\ state\ {\isacharparenleft}hd\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharparenleft}state\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}Suc{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}disj\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ states{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game\ n\ states{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state\ {\isacharequal}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ labeled{\isacharunderscore}move\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ l{\isacharunderscore}state\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isasymin}\ l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Max{\isacharunderscore}in\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ card{\isacharunderscore}empty\ card{\isacharunderscore}infinite\ less{\isacharunderscore}le{\isacharunderscore}trans\ nat{\isacharunderscore}neq{\isacharunderscore}iff\ nth{\isacharunderscore}map\ trans{\isacharunderscore}less{\isacharunderscore}add{\isadigit{1}}\ unlabel{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ less{\isacharunderscore}le{\isacharunderscore}trans\ nth{\isacharunderscore}map\ trans{\isacharunderscore}less{\isacharunderscore}add{\isadigit{1}}\ unlabel{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}l{\isacharunderscore}state{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ {\isacharparenleft}state{\isacharprime}\ {\isacharhash}\ states{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ {\isacharparenleft}let\ state\ {\isacharequal}\ unlabel\ l{\isacharunderscore}state{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ labeled{\isacharunderscore}move\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ l{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \ in\ l{\isacharunderscore}state\ {\isacharhash}\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state{\isacharprime}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ hd{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}hd\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ states{\isacharparenright}\ {\isacharequal}\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ states{\isacharparenright}\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Let{\isacharunderscore}def\ split{\isacharcolon}\ prod{\isachardot}split{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}states{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ l{\isacharunderscore}state{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ states{\isacharparenright}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ states\ arbitrary{\isacharcolon}\ l{\isacharunderscore}state{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ state{\isacharprime}\ states{\isacharparenright}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}state\ {\isacharequal}\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p\ {\isacharequal}\ {\isachardoublequoteopen}move{\isacharunderscore}positions\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{1}}\ {\isacharequal}\ {\isachardoublequoteopen}fst\ {\isacharquery}p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{2}}\ {\isacharequal}\ {\isachardoublequoteopen}snd\ {\isacharquery}p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}stone\ {\isacharequal}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ {\isacharquery}p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}stone\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ unlabel{\isacharunderscore}valid{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}left{\isacharprime}\ add{\isacharunderscore}is{\isacharunderscore}{\isadigit{0}}\ gr{\isadigit{0}}I\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ n{\isacharunderscore}not{\isacharunderscore}Suc{\isacharunderscore}n\ nth{\isacharunderscore}Cons{\isacharunderscore}{\isadigit{0}}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}move\ n\ {\isacharquery}state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}stone\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state\ {\isacharequal}\ unlabel\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}move\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ unlabel{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharbrackleft}OF\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharcomma}\ THEN\ conjunct{\isadigit{2}}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ l{\isacharunderscore}state{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ states{\isacharparenright}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ Cons{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ {\isacharbackquoteopen}valid{\isacharunderscore}move\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isacharunderscore}Suc{\isacharunderscore}right\ diff{\isacharunderscore}add{\isacharunderscore}inverse{\isadigit{2}}\ group{\isacharunderscore}cancel{\isachardot}add{\isadigit{1}}\ less{\isacharunderscore}diff{\isacharunderscore}conv\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ prod{\isachardot}collapse\ prod{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ set{\isacharunderscore}ConsD{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unlabel{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}map\ unlabel\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ states{\isacharparenright}\ {\isacharequal}\ unlabel\ l{\isacharunderscore}state\ {\isacharhash}\ states{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ states\ arbitrary{\isacharcolon}\ l{\isacharunderscore}state{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ state{\isacharprime}\ states{\isacharparenright}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}state\ {\isacharequal}\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p\ {\isacharequal}\ {\isachardoublequoteopen}move{\isacharunderscore}positions\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{1}}\ {\isacharequal}\ {\isachardoublequoteopen}fst\ {\isacharquery}p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{2}}\ {\isacharequal}\ {\isachardoublequoteopen}snd\ {\isacharquery}p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}stone\ {\isacharequal}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ {\isacharquery}p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}stone\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ unlabel{\isacharunderscore}valid{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}left{\isacharprime}\ add{\isacharunderscore}is{\isacharunderscore}{\isadigit{0}}\ gr{\isadigit{0}}I\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ n{\isacharunderscore}not{\isacharunderscore}Suc{\isacharunderscore}n\ nth{\isacharunderscore}Cons{\isacharunderscore}{\isadigit{0}}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}move\ n\ {\isacharquery}state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}stone\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state\ {\isacharequal}\ unlabel\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}move\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ unlabel{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharbrackleft}OF\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharcomma}\ THEN\ conjunct{\isadigit{2}}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ unlabel\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ states{\isacharparenright}\ {\isacharequal}\ unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharhash}\ states{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ Cons{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}{\isacharparenleft}unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isacharparenright}\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}diff{\isacharunderscore}conv\ valid{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacartoucheopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}\ state{\isacharprime}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}state\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state{\isacharparenright}{\isacartoucheclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Cons{\isacharunderscore}eq{\isacharunderscore}map{\isacharunderscore}conv\ case{\isacharunderscore}prod{\isacharunderscore}conv\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}move{\isacharunderscore}positions{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}length\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ states{\isacharparenright}\ {\isacharequal}\ length\ states\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ states\ arbitrary{\isacharcolon}\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharparenleft}auto\ split{\isacharcolon}\ prod{\isachardot}split{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}moves{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ l{\isacharunderscore}state\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ l{\isacharunderscore}state\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ states\ arbitrary{\isacharcolon}\ l{\isacharunderscore}state{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ state{\isacharprime}\ states{\isacharparenright}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}state\ {\isacharequal}\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p\ {\isacharequal}\ {\isachardoublequoteopen}move{\isacharunderscore}positions\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{1}}\ {\isacharequal}\ {\isachardoublequoteopen}fst\ {\isacharquery}p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{2}}\ {\isacharequal}\ {\isachardoublequoteopen}snd\ {\isacharquery}p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}stone\ {\isacharequal}\ {\isachardoublequoteopen}Max\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ {\isacharquery}p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}stone\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ unlabel{\isacharunderscore}valid{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move\ n\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}left{\isacharprime}\ add{\isacharunderscore}is{\isacharunderscore}{\isadigit{0}}\ gr{\isadigit{0}}I\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ n{\isacharunderscore}not{\isacharunderscore}Suc{\isacharunderscore}n\ nth{\isacharunderscore}Cons{\isacharunderscore}{\isadigit{0}}\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}move\ n\ {\isacharquery}state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}stone\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state\ {\isacharequal}\ unlabel\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}move\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ unlabel{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}{\isacharbrackleft}OF\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ {\isacharasterisk}{\isacharasterisk}{\isacharcomma}\ THEN\ conjunct{\isadigit{2}}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ Cons{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}{\isacharparenleft}unlabel\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isacharparenright}\ {\isacharhash}\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}diff{\isacharunderscore}conv\ valid{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ l{\isacharunderscore}state\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}hd\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}\ states{\isacharparenright}\ {\isacharequal}\ {\isacharquery}l{\isacharunderscore}state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharasterisk}\ {\isacartoucheopen}valid{\isacharunderscore}move{\isacharprime}\ n\ {\isacharquery}p{\isadigit{1}}\ {\isacharquery}p{\isadigit{2}}\ {\isacharquery}state\ state{\isacharprime}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}state\ n\ {\isacharquery}state{\isacartoucheclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}Cons\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ case{\isacharunderscore}prod{\isacharunderscore}conv\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ valid{\isacharunderscore}move{\isacharprime}{\isacharunderscore}move{\isacharunderscore}positions{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}unique{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}unlabel\ l{\isacharunderscore}state\ {\isacharequal}\ final{\isacharunderscore}state\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}l{\isacharunderscore}state\ {\isacharequal}\ final{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ i\ {\isasymle}\ n{\isachardot}\ finite\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ Union{\isacharunderscore}upper\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ finite{\isacharunderscore}atLeastLessThan\ finite{\isacharunderscore}subset\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ nth{\isacharunderscore}mem\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ i\ {\isacharless}\ n{\isachardot}\ card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ i{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ unlabel{\isacharunderscore}def\ final{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ le{\isacharunderscore}imp{\isacharunderscore}less{\isacharunderscore}Suc\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ nat{\isacharunderscore}neq{\isacharunderscore}iff\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}neq\ nth{\isacharunderscore}map\ nth{\isacharunderscore}replicate{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}l{\isacharunderscore}state\ {\isacharbang}\ n{\isacharparenright}\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ unlabel{\isacharunderscore}def\ final{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ length{\isacharunderscore}replicate\ less{\isacharunderscore}add{\isacharunderscore}same{\isacharunderscore}cancel{\isadigit{1}}\ less{\isacharunderscore}one\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}eq\ nth{\isacharunderscore}map{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharparenleft}set\ l{\isacharunderscore}state{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ unlabel{\isacharunderscore}def\ final{\isacharunderscore}state{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ i\ {\isacharless}\ n{\isachardot}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}l{\isacharunderscore}state\ {\isacharbang}\ n\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\isadigit{1}}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ Union{\isacharunderscore}upper\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ card{\isacharunderscore}atLeastLessThan\ card{\isacharunderscore}subset{\isacharunderscore}eq\ diff{\isacharunderscore}zero\ finite{\isacharunderscore}atLeastLessThan\ less{\isacharunderscore}add{\isacharunderscore}same{\isacharunderscore}cancel{\isadigit{1}}\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\ zero{\isacharunderscore}less{\isacharunderscore}one{\isacharparenright}\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ nth{\isacharunderscore}equalityI{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ length\ {\isacharparenleft}final{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ del{\isacharcolon}\ replicate{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ l{\isacharunderscore}state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isacharequal}\ final{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}\ i\ {\isacharless}\ n{\isachardot}\ l{\isacharunderscore}state\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}l{\isacharunderscore}state\ {\isacharbang}\ n\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbraceright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}state\ {\isacharequal}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ add{\isachardot}commute\ length{\isacharunderscore}replicate\ less{\isacharunderscore}Suc{\isacharunderscore}eq\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}eq\ nth{\isacharunderscore}list{\isacharunderscore}update{\isacharunderscore}neq\ nth{\isacharunderscore}replicate\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}length\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}game\ n\ states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharparenleft}tl\ states{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ length\ states{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ assms\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ length{\isacharunderscore}map\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ not{\isacharunderscore}le\ unlabel{\isacharunderscore}initial\ unlabel{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ valid{\isacharunderscore}game{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}initial{\isacharunderscore}labeled{\isacharunderscore}state\ zero{\isacharunderscore}less{\isacharunderscore}numeral{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}game\ n\ states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharparenleft}tl\ states{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l{\isacharunderscore}states\ {\isacharequal}\ {\isachardoublequoteopen}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharparenleft}tl\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharhash}\ tl\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isacharunderscore}diff{\isacharunderscore}cancel{\isacharunderscore}left{\isacharprime}\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ list{\isachardot}sel{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ n{\isacharunderscore}not{\isacharunderscore}Suc{\isacharunderscore}n\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ unlabel{\isacharunderscore}initial\ upt{\isacharunderscore}{\isadigit{0}}\ upt{\isacharunderscore}rec\ valid{\isacharunderscore}game{\isacharunderscore}def\ valid{\isacharunderscore}moves{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}map\ unlabel\ {\isacharquery}l{\isacharunderscore}states\ {\isacharequal}\ {\isacharparenleft}initial{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharhash}\ tl\ states{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ unlabel{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharbrackleft}of\ n\ {\isachardoublequoteopen}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}tl\ states{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}unlabel\ {\isacharparenleft}hd\ {\isacharquery}l{\isacharunderscore}states{\isacharparenright}\ {\isacharequal}\ initial{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}hd\ {\isacharquery}l{\isacharunderscore}states\ {\isacharequal}\ initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}unlabel\ {\isacharparenleft}last\ {\isacharquery}l{\isacharunderscore}states{\isacharparenright}\ {\isacharequal}\ final{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}game{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isachardoublequoteopen}{\isacharasterisk}{\isachardoublequoteclose}\ Nil{\isacharunderscore}is{\isacharunderscore}map{\isacharunderscore}conv\ hd{\isacharunderscore}Cons{\isacharunderscore}tl\ last{\isacharunderscore}map\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ not{\isacharunderscore}le\ zero{\isacharunderscore}less{\isacharunderscore}numeral{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}last\ {\isacharquery}l{\isacharunderscore}states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ {\isacartoucheopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharhash}\ tl\ states{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ last{\isacharunderscore}in{\isacharunderscore}set\ list{\isachardot}discI\ list{\isachardot}simps{\isacharparenleft}{\isadigit{8}}{\isacharparenright}\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}initial{\isacharunderscore}labeled{\isacharunderscore}state\ valid{\isacharunderscore}states{\isacharunderscore}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}last\ {\isacharquery}l{\isacharunderscore}states\ {\isacharequal}\ final{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}unique\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharparenleft}tl\ states{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}moves{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}moves\ n\ {\isacharparenleft}unlabel\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharhash}\ tl\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ {\isacharparenleft}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharparenleft}tl\ states{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}game{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Valid labeled game move max stone length%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ moved{\isacharunderscore}from{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}i\ {\isacharless}\ j{\isachardoublequoteclose}\ {\isachardoublequoteopen}j\ {\isacharless}\ length\ l{\isacharunderscore}states{\isachardoublequoteclose}\ {\isachardoublequoteopen}stone\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ i{\isacharparenright}\ stone\ {\isasymnoteq}\ stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ j{\isacharparenright}\ stone{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ k{\isachardot}\ i\ {\isasymle}\ k\ {\isasymand}\ k\ {\isacharless}\ j\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}let\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isacharequal}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ in\ \isanewline
\ \ \ \ \ \ \ \ \ \ stone{\isacharprime}\ {\isacharequal}\ stone\ {\isasymand}\ p{\isadigit{1}}\ {\isacharequal}\ stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ i{\isacharparenright}\ stone{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharunderscore}states\ arbitrary{\isacharcolon}\ i\ j{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ l{\isacharunderscore}state\ l{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isacharprime}\ \isakeyword{where}\ \isanewline
\ \ \ \ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isacharequal}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ prod{\isacharunderscore}cases{\isadigit{3}}{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharminus}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ less{\isacharunderscore}le{\isacharunderscore}trans\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move\ n\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharminus}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isacharprime}\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isacharequal}\ stone{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharequal}\ stone{\isacharunderscore}position\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}\ stone{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}{\isacartoucheclose}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\ Cons{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ True\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ x{\isacharequal}i\ \isakeyword{in}\ exI{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isacharequal}\ stone{\isacharunderscore}position\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}\ stone{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions{\isacharunderscore}other{\isacharbrackleft}OF\ {\isacharasterisk}{\isacharasterisk}{\isacharasterisk}\ {\isacharasterisk}{\isacharasterisk}{\isacharbrackright}\ {\isacharbackquoteopen}stone{\isacharprime}\ {\isasymnoteq}\ stone{\isacharbackquoteclose}\ {\isacharbackquoteopen}stone\ {\isacharless}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ i{\isacharparenright}\ stone\ {\isasymnoteq}\ stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}j\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ Cons{\isacharparenleft}{\isadigit{7}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}l{\isacharunderscore}states\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ Cons{\isacharparenleft}{\isadigit{5}}{\isacharparenright}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{2}}{\isacharminus}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ hd{\isacharunderscore}in{\isacharunderscore}set\ list{\isachardot}set{\isacharunderscore}intros{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Groups{\isachardot}add{\isacharunderscore}ac{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ less{\isacharunderscore}diff{\isacharunderscore}conv\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}\ j\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}antisym\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}j\ {\isacharminus}\ {\isadigit{1}}\ {\isacharless}\ length\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}i\ {\isacharless}\ j{\isacharbackquoteclose}\ Cons{\isacharparenleft}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isasymle}\ k{\isachardoublequoteclose}\ {\isachardoublequoteopen}k\ {\isacharless}\ j\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}let\ {\isacharparenleft}p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isacharequal}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ in\ \isanewline
\ \ \ \ \ \ \ \ \ \ stone{\isacharprime}\ {\isacharequal}\ stone\ {\isasymand}\ p{\isadigit{1}}\ {\isacharequal}\ stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ i{\isacharparenright}\ stone{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}of\ {\isachardoublequoteopen}i{\isachardoublequoteclose}\ {\isachardoublequoteopen}j{\isacharminus}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}\ {\isacharbackquoteopen}stone\ {\isacharless}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}Cons{\isacharparenright}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}stone{\isacharunderscore}position\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isacharequal}\ stone{\isacharunderscore}position\ {\isacharparenleft}{\isacharparenleft}l{\isacharunderscore}state\ {\isacharhash}\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharbang}\ i{\isacharparenright}\ stone{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ x{\isacharequal}{\isachardoublequoteopen}k{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharparenright}\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Let{\isacharunderscore}def\ nth{\isacharunderscore}Cons{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}min{\isacharunderscore}length{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isacharparenleft}{\isasymSum}\ k\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}n{\isacharplus}{\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharparenleft}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ k{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}l{\isacharunderscore}states\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}ss\ {\isacharequal}\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ state{\isacharprime}{\isacharparenright}{\isachardot}\ {\isacharparenleft}state{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}zip\ {\isacharparenleft}butlast\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharparenleft}tl\ l{\isacharunderscore}states{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}sstone\ {\isacharequal}\ {\isachardoublequoteopen}{\isasymlambda}\ stone{\isachardot}\ filter\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}{\isachardot}\ stone{\isacharprime}\ {\isacharequal}\ stone{\isacharparenright}\ {\isacharquery}ss{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ k\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}n{\isacharplus}{\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharparenleft}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ k{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ stone\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isachardot}\ {\isacharparenleft}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}n{\isacharplus}{\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ map{\isacharunderscore}add{\isacharunderscore}upt\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sum{\isacharunderscore}list{\isacharunderscore}comp{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isasymle}\ {\isacharparenleft}{\isasymSum}\ stone\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isachardot}\ int\ {\isacharparenleft}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ sum{\isacharunderscore}list{\isacharunderscore}mono{\isacharparenright}\ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ stone\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isasymle}\ int\ {\isacharparenleft}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ ccontr{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharquery}thesis{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isachargreater}\ int\ {\isacharparenleft}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ {\isacharparenleft}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isacharparenright}\ {\isacharasterisk}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lt{\isacharunderscore}ceiling{\isacharunderscore}frac\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}\ {\isacharasterisk}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ of{\isacharunderscore}nat{\isacharunderscore}less{\isacharunderscore}imp{\isacharunderscore}less\ of{\isacharunderscore}nat{\isacharunderscore}mult{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ ss\ \isakeyword{where}\ ss{\isacharcolon}\ {\isachardoublequoteopen}ss\ {\isacharequal}\ {\isacharquery}sstone\ stone{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isasymin}\ set\ ss{\isachardot}\ stone{\isacharprime}\ {\isacharequal}\ \ Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}\ state{\isacharprime}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isacharprime}\ state\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ state\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isacharprime}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isasymin}\ set\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isasymin}\ set\ {\isacharquery}ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ state{\isacharprime}\ \isakeyword{where}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}state{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}state{\isacharcomma}\ state{\isacharprime}{\isacharparenright}\ {\isasymin}\ set\ {\isacharparenleft}zip\ {\isacharparenleft}butlast\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharparenleft}tl\ l{\isacharunderscore}states{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}{\isacharparenleft}zip\ {\isacharparenleft}butlast\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharparenleft}tl\ l{\isacharunderscore}states{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}zip\ {\isacharparenleft}butlast\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharparenleft}tl\ l{\isacharunderscore}states{\isacharparenright}{\isacharparenright}\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharparenleft}state{\isacharcomma}\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}l{\isacharunderscore}states\ {\isacharbang}\ i\ {\isacharequal}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ nth{\isacharunderscore}butlast{\isacharbrackleft}of\ i\ l{\isacharunderscore}states{\isacharbrackright}\ nth{\isacharunderscore}tl{\isacharbrackleft}of\ i\ l{\isacharunderscore}states{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone\ n\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}i\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}l{\isacharunderscore}states\ {\isacharbang}\ i\ {\isacharequal}\ state{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ add{\isacharunderscore}lessD{\isadigit{1}}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ less{\isacharunderscore}diff{\isacharunderscore}conv\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}state{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isacharequal}\ Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}state{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ state\ state{\isacharprime}{\isacharparenright}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ state\ state{\isacharprime}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ state{\isacartoucheclose}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ state{\isacharprime}{\isachardot}\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isacharprime}\ state\ state{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ pos{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isadigit{0}}{\isacharparenright}\ stone\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}l{\isacharunderscore}states\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ stone{\isacharunderscore}positionI{\isacharbrackleft}of\ n\ {\isachardoublequoteopen}l{\isacharunderscore}states\ {\isacharbang}\ {\isadigit{0}}{\isachardoublequoteclose}\ stone\ {\isadigit{0}}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}conv{\isacharunderscore}nth{\isacharbrackleft}of\ l{\isacharunderscore}states{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}initial{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\ initial{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ posn{\isacharcolon}\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ stone{\isacharunderscore}positionI{\isacharbrackleft}of\ n\ {\isachardoublequoteopen}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ stone\ n{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}l{\isacharunderscore}states\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ last{\isacharunderscore}conv{\isacharunderscore}nth{\isacharbrackleft}of\ l{\isacharunderscore}states{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}final{\isacharunderscore}labeled{\isacharunderscore}state\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\ final{\isacharunderscore}labeled{\isacharunderscore}state{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ del{\isacharcolon}\ replicate{\isacharunderscore}Suc{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}\ {\isacharasterisk}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ n{\isacartoucheclose}\ gr{\isacharunderscore}implies{\isacharunderscore}not{\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ ss\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ ccontr{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharquery}thesis{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}sstone\ stone\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ Suc{\isacharunderscore}leI\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{2}}\ k\ \isakeyword{where}\ {\isachardoublequoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\isadigit{0}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isacharequal}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ moved{\isacharunderscore}from{\isacharbrackleft}of\ n\ l{\isacharunderscore}states\ {\isadigit{0}}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ stone{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ pos{\isadigit{0}}\ posn\ {\isacharbackquoteopen}n\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharcomma}\ l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isasymin}\ set\ {\isacharparenleft}zip\ {\isacharparenleft}butlast\ l{\isacharunderscore}states{\isacharparenright}\ {\isacharparenleft}tl\ l{\isacharunderscore}states{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ length{\isacharunderscore}butlast\ length{\isacharunderscore}tl\ length{\isacharunderscore}zip\ min{\isacharunderscore}less{\isacharunderscore}iff{\isacharunderscore}conj\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl\ nth{\isacharunderscore}zip{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharcomma}\ {\isadigit{0}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymin}\ set\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}sstone\ stone\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}ss\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ {\isacharquery}sstone\ stone{\isachardot}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{2}}p{\isadigit{1}}\ {\isacharequal}\ {\isachardoublequoteopen}{\isasymlambda}\ i{\isachardot}\ case\ ss\ {\isacharbang}\ i\ of\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ int\ p{\isadigit{2}}\ {\isacharminus}\ int\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{1}}\ {\isacharequal}\ {\isachardoublequoteopen}{\isasymlambda}\ i{\isachardot}\ case\ ss\ {\isacharbang}\ i\ of\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ int\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p{\isadigit{2}}\ {\isacharequal}\ {\isachardoublequoteopen}{\isasymlambda}\ i{\isachardot}\ case\ ss\ {\isacharbang}\ i\ of\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ int\ p{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ ss{\isachardot}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ ss{\isachardot}\ int\ {\isacharparenleft}p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ ss{\isachardot}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ ss{\isachardot}\ int\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}\ map{\isacharunderscore}nth\ sum{\isacharunderscore}list{\isacharunderscore}comp\ sum{\isacharunderscore}list{\isacharunderscore}int{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isasymleftarrow}ss{\isachardot}\ int\ {\isacharparenleft}p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}map\ int\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ ss{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ int\ {\isacharparenleft}p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ ss{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharasterisk}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ ss{\isachardot}\ int\ p{\isadigit{2}}\ {\isacharminus}\ int\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymin}\ set\ ss{\isachardot}\ p{\isadigit{2}}\ {\isasymge}\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}moves{\isacharprime}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymin}\ set\ ss{\isachardot}\ int\ {\isacharparenleft}p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ int\ p{\isadigit{2}}\ {\isacharminus}\ int\ p{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ int\ {\isacharparenleft}p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ ss\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ int\ p{\isadigit{2}}\ {\isacharminus}\ int\ p{\isadigit{1}}{\isacharparenright}\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharasterisk}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ \ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{2}}p{\isadigit{1}}\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}\ map{\isacharunderscore}nth\ sum{\isacharunderscore}list{\isacharunderscore}comp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{2}}\ i{\isacharparenright}\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{1}}\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ i\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{2}}p{\isadigit{1}}\ i\ {\isacharequal}\ {\isacharquery}p{\isadigit{2}}\ i\ {\isacharminus}\ {\isacharquery}p{\isadigit{1}}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ split{\isacharcolon}\ prod{\isachardot}split{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharquery}p{\isadigit{2}}p{\isadigit{1}}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}\ {\isacharequal}\ map\ {\isacharparenleft}{\isasymlambda}\ i{\isachardot}\ {\isacharquery}p{\isadigit{2}}\ i\ {\isacharminus}\ {\isacharquery}p{\isadigit{1}}\ i{\isacharparenright}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sum{\isacharunderscore}list{\isacharunderscore}subtractf{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharcomma}\ presburger{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharminus}{\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{2}}\ i{\isacharparenright}\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{1}}\ i{\isacharparenright}\ {\isacharplus}\ {\isacharparenleft}{\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}length\ ss{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isacharparenleft}{\isacharquery}p{\isadigit{1}}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharminus}{\isadigit{1}}{\isacharbrackright}\ {\isacharat}\ {\isacharbrackleft}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isadigit{0}}{\isacharbrackright}\ {\isacharat}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ ss\ {\isasymge}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ le{\isacharunderscore}add{\isacharunderscore}diff{\isacharunderscore}inverse\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc\ upt{\isacharunderscore}Suc{\isacharunderscore}append\ zero{\isacharunderscore}le{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ le{\isacharunderscore}add{\isacharunderscore}diff{\isacharunderscore}inverse\ less{\isacharunderscore}numeral{\isacharunderscore}extra{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ upt{\isacharunderscore}add{\isacharunderscore}eq{\isacharunderscore}append\ upt{\isacharunderscore}rec\ zero{\isacharunderscore}le{\isacharunderscore}one\ zero{\isacharunderscore}less{\isacharunderscore}one{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}list{\isacharunderscore}append\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ list{\isachardot}map{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ list{\isachardot}map{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ map{\isacharunderscore}append\ sum{\isacharunderscore}list{\isacharunderscore}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ ss{\isachardot}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharminus}{\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{2}}\ i{\isacharparenright}\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{1}}\ i{\isacharparenright}\ {\isacharplus}\ {\isacharparenleft}{\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}length\ ss{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isacharparenleft}{\isacharquery}p{\isadigit{1}}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}P\ {\isacharequal}\ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}{\isachardot}\ stone{\isacharprime}\ {\isacharequal}\ stone{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{1}}\ i{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharquery}p{\isadigit{2}}\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ i{\isachardot}\ {\isadigit{0}}\ {\isacharless}\ i\ {\isasymand}\ i\ {\isacharless}\ length\ ss\ {\isasymlongrightarrow}\ {\isacharquery}p{\isadigit{1}}\ i\ {\isacharequal}\ {\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}i{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ i{\isachardoublequoteclose}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p{\isadigit{1}}\ i\ {\isacharequal}\ {\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}i{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ ccontr{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharquery}thesis{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ k{\isadigit{1}}\ k{\isadigit{2}}\ \isakeyword{where}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}ss\ {\isacharbang}\ {\isacharparenleft}i{\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}ss\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}\ {\isasymlongrightarrow}\ {\isasymnot}\ {\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\ inside{\isacharunderscore}filter{\isacharbrackleft}of\ {\isachardoublequoteopen}i{\isacharminus}{\isadigit{1}}{\isachardoublequoteclose}\ {\isacharquery}P\ {\isacharquery}ss{\isacharbrackright}\ {\isacharbackquoteopen}{\isadigit{0}}\ {\isacharless}\ i{\isacharbackquoteclose}\ {\isacharbackquoteopen}i\ {\isacharless}\ length\ ss{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}ss\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{1}}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{2}}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}a\ p{\isadigit{2}}a\ p{\isadigit{1}}b\ p{\isadigit{2}}b\ \isakeyword{where}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{1}}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharcomma}\ p{\isadigit{1}}a{\isacharcomma}\ p{\isadigit{2}}a{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}a{\isacharcomma}\ p{\isadigit{2}}a{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{2}}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharcomma}\ p{\isadigit{1}}b{\isacharcomma}\ p{\isadigit{2}}b{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}b{\isacharcomma}\ p{\isadigit{2}}b{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{2}}a\ {\isasymnoteq}\ p{\isadigit{1}}b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}p{\isadigit{1}}\ i\ {\isasymnoteq}\ {\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}i{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}ss\ {\isacharbang}\ {\isacharparenleft}i{\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}ss\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isasymnoteq}\ stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ stone{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacartoucheclose}\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ l{\isacharunderscore}states{\isacartoucheclose}\ assms\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ less{\isacharunderscore}le{\isacharunderscore}trans\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}a\ p{\isadigit{2}}a\ stone\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}a{\isacharcomma}\ p{\isadigit{2}}a{\isacharcomma}\ stone{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacartoucheclose}\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ l{\isacharunderscore}states{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacartoucheclose}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isacharequal}\ p{\isadigit{2}}a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ l{\isacharunderscore}states{\isacartoucheclose}\ assms\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat\ less{\isacharunderscore}le{\isacharunderscore}trans\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}b\ p{\isadigit{2}}b\ stone\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}b{\isacharcomma}\ p{\isadigit{2}}b{\isacharcomma}\ stone{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}ss{\isacartoucheclose}\ \ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacartoucheclose}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ length{\isacharunderscore}butlast\ length{\isacharunderscore}map\ length{\isacharunderscore}tl\ length{\isacharunderscore}zip\ min{\isacharunderscore}less{\isacharunderscore}iff{\isacharunderscore}conj{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ stone\ {\isacharequal}\ p{\isadigit{1}}b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ stone\ {\isacharequal}\ p{\isadigit{1}}b{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isacharequal}\ p{\isadigit{2}}a{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p{\isadigit{2}}a\ {\isasymnoteq}\ p{\isadigit{1}}b{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}eq{\isacharunderscore}plus{\isadigit{1}}\ Suc{\isacharunderscore}leI\ nat{\isacharunderscore}less{\isacharunderscore}le{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k{\isacharprime}\ p{\isadigit{1}}{\isacharprime}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isasymle}\ k{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}\ {\isacharequal}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharprime}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isasymnoteq}\ stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isadigit{2}}{\isacharparenright}\ stone{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ moved{\isacharunderscore}from{\isacharbrackleft}of\ n\ l{\isacharunderscore}states\ {\isachardoublequoteopen}k{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isadigit{2}}{\isachardoublequoteclose}\ stone{\isacharbrackright}\ {\isacharbackquoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ l{\isacharunderscore}states{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharprime}{\isacharcomma}\ p{\isadigit{1}}{\isacharprime}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isadigit{2}}\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k{\isadigit{1}}\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}\ {\isasymlongrightarrow}\ {\isasymnot}\ {\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ k{\isacharprime}{\isacharbrackright}\ {\isacharbackquoteopen}k{\isadigit{1}}\ {\isacharplus}\ {\isadigit{1}}\ {\isasymle}\ k{\isacharprime}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isacharprime}\ {\isacharless}\ k{\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharquery}p{\isadigit{1}}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}length\ ss{\isacharbrackright}\ {\isacharequal}\ map\ {\isacharquery}p{\isadigit{2}}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}lhs\ {\isacharequal}\ {\isacharquery}rhs{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ nth{\isacharunderscore}equalityI{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharquery}lhs\ {\isacharequal}\ length\ {\isacharquery}rhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharquery}lhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}lhs\ {\isacharbang}\ i\ {\isacharequal}\ {\isacharquery}rhs\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ ccontr{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharquery}thesis{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isachardoublequoteclose}\ {\isachardoublequoteopen}ss\ {\isacharbang}\ {\isacharparenleft}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ length\ {\isacharquery}ss\ {\isasymlongrightarrow}\ \ {\isasymnot}\ {\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\ last{\isacharunderscore}filter{\isacharbrackleft}of\ {\isacharquery}P\ {\isacharquery}ss{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}ss\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ \ {\isachardoublequoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharcomma}\ p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{2}}{\isacharprime}\ {\isasymnoteq}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}p{\isadigit{2}}\ {\isacharparenleft}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ {\isasymnoteq}\ n{\isacharbackquoteclose}\ {\isacharbackquoteopen}ss\ {\isacharbang}\ {\isacharparenleft}length\ ss\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isasymnoteq}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isacharequal}\ p{\isadigit{2}}{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ stone\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isacartoucheclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ add{\isacharunderscore}lessD{\isadigit{1}}\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}\ less{\isacharunderscore}diff{\isacharunderscore}conv\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isacartoucheclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p{\isadigit{2}}{\isacharprime}\ {\isasymnoteq}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharplus}\ {\isadigit{1}}\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ posn\ {\isacartoucheopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Nat{\isachardot}le{\isacharunderscore}diff{\isacharunderscore}conv{\isadigit{2}}\ Nat{\isachardot}le{\isacharunderscore}imp{\isacharunderscore}diff{\isacharunderscore}is{\isacharunderscore}add\ Suc{\isacharunderscore}leI\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ add{\isacharunderscore}leD{\isadigit{2}}\ diff{\isacharunderscore}diff{\isacharunderscore}left\ nat{\isacharunderscore}less{\isacharunderscore}le\ one{\isacharunderscore}add{\isacharunderscore}one\ plus{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k{\isacharprime}\ p{\isadigit{1}}{\isacharprime}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isasymge}\ k\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}\ {\isacharequal}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharprime}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ moved{\isacharunderscore}from{\isacharbrackleft}of\ n\ l{\isacharunderscore}states\ {\isachardoublequoteopen}k{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ stone{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ posn\ {\isacharbackquoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ stone\ {\isasymnoteq}\ n{\isacharbackquoteclose}\ {\isacharbackquoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharprime}{\isacharcomma}\ p{\isadigit{1}}{\isacharprime}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}\ k{\isacharprime}{\isachardot}\ k\ {\isacharless}\ k{\isacharprime}\ {\isasymand}\ k{\isacharprime}\ {\isacharless}\ length\ {\isacharquery}ss\ {\isasymlongrightarrow}\ {\isasymnot}\ {\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ k{\isacharprime}{\isacharbrackright}\ {\isacharbackquoteopen}k{\isacharprime}\ {\isasymge}\ k\ {\isacharplus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}k{\isacharprime}\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p{\isadigit{1}}\ {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ ccontr{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharquery}thesis{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isachardoublequoteclose}\ {\isachardoublequoteopen}ss\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isachardot}\ {\isasymnot}\ {\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\ hd{\isacharunderscore}filter{\isacharbrackleft}of\ {\isacharquery}P\ {\isacharquery}ss{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}ss\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ \ {\isachardoublequoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharcomma}\ labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharcomma}\ p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{1}}{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isacharquery}p{\isadigit{1}}\ {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}ss\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ {\isacharquery}ss\ {\isacharbang}\ k{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ stone\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ {\isacartoucheopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacartoucheclose}\ add{\isacharunderscore}lessD{\isadigit{1}}\ assms\ less{\isacharunderscore}diff{\isacharunderscore}conv\ nth{\isacharunderscore}mem\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}game\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}valid{\isacharunderscore}labeled{\isacharunderscore}states{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}{\isacharprime}\ p{\isadigit{2}}{\isacharprime}\ stone\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}p{\isadigit{1}}{\isacharprime}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacartoucheclose}\ {\isacartoucheopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacartoucheclose}\ labeled{\isacharunderscore}move{\isacharunderscore}positions{\isacharunderscore}valid{\isacharunderscore}move{\isacharprime}\ valid{\isacharunderscore}labeled{\isacharunderscore}moves{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ stone\ {\isacharequal}\ p{\isadigit{1}}{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}stone{\isacharunderscore}positions\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p{\isadigit{1}}{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ pos{\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ neq{\isadigit{0}}{\isacharunderscore}conv\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k{\isacharprime}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}k{\isacharprime}\ {\isacharless}\ k{\isachardoublequoteclose}\ {\isachardoublequoteopen}labeled{\isacharunderscore}move{\isacharunderscore}positions\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ {\isacharparenleft}k{\isacharprime}\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isadigit{0}}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ moved{\isacharunderscore}from{\isacharbrackleft}of\ n\ l{\isacharunderscore}states\ {\isadigit{0}}\ k\ stone{\isacharbrackright}\ pos{\isadigit{0}}\ {\isacharbackquoteopen}stone{\isacharunderscore}position\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharparenright}\ stone\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}state\ n\ {\isacharparenleft}hd\ l{\isacharunderscore}states{\isacharparenright}{\isacharbackquoteclose}\ {\isacharbackquoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}moves\ n\ l{\isacharunderscore}states{\isacharbackquoteclose}\ {\isacharbackquoteopen}k\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}stone\ {\isasymin}\ set\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}l{\isacharunderscore}states\ {\isacharbang}\ k{\isacharprime}{\isacharcomma}\ {\isadigit{0}}{\isacharcomma}\ p{\isadigit{2}}{\isacharprime}{\isacharprime}{\isacharcomma}\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k{\isacharprime}\ {\isacharless}\ k{\isacharbackquoteclose}\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ l{\isacharunderscore}states\ {\isacharminus}\ {\isadigit{1}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}k\ {\isacharless}\ length\ {\isacharquery}ss{\isacharbackquoteclose}\ {\isacharbackquoteopen}length\ l{\isacharunderscore}states\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ nth{\isacharunderscore}butlast\ nth{\isacharunderscore}tl{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymforall}\ k{\isacharprime}\ {\isacharless}\ k{\isachardot}\ {\isasymnot}\ {\isacharquery}P\ {\isacharparenleft}{\isacharquery}ss\ {\isacharbang}\ k{\isacharprime}{\isacharparenright}{\isacharbackquoteclose}{\isacharbrackleft}rule{\isacharunderscore}format{\isacharcomma}\ of\ k{\isacharprime}{\isacharbrackright}\ {\isacharbackquoteopen}k{\isacharprime}\ {\isacharless}\ k{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isasymle}\ {\isacharparenleft}{\isasymSum}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymleftarrow}\ {\isacharquery}sstone\ stone{\isachardot}\ stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ sum{\isacharunderscore}list{\isacharunderscore}mono{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}labeled{\isacharunderscore}state\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ state\ p{\isadigit{1}}\ p{\isadigit{2}}\ stone{\isacharprime}\ \isakeyword{where}\ x{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ x{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ss\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ state{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}stone{\isacharprime}\ {\isacharequal}\ Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}\ n\ p{\isadigit{1}}\ p{\isadigit{2}}\ {\isacharparenleft}Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ state\ state{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x\ valid{\isacharunderscore}moves{\isacharprime}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isadigit{1}}\ {\isacharless}\ p{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p{\isadigit{2}}\ {\isasymle}\ p{\isadigit{1}}\ {\isacharplus}\ card\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}move{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isasymle}\ Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ card{\isacharunderscore}Max{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}case\ x\ of\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ p{\isadigit{2}}\ {\isacharminus}\ p{\isadigit{1}}{\isacharparenright}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}case\ x\ of\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}\ {\isasymRightarrow}\ stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x\ {\isacharbackquoteopen}stone{\isacharprime}\ {\isacharequal}\ Max\ {\isacharparenleft}state\ {\isacharbang}\ p{\isadigit{1}}{\isacharparenright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}{\isasymSum}\ x\ {\isasymleftarrow}\ {\isacharquery}sstone\ stone{\isachardot}\ stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}\ {\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharparenright}{\isachardot}\ stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ map\ {\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}\ {\isacharasterisk}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sum{\isacharunderscore}list{\isacharunderscore}triv{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}\ {\isacharasterisk}\ {\isacharparenleft}stone\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharless}\ n{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isasymle}\ length\ {\isacharquery}ss{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}ps\ {\isacharequal}\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}\ stone{\isachardot}\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}state{\isacharcomma}\ p{\isadigit{1}}{\isacharcomma}\ p{\isadigit{2}}{\isacharcomma}\ stone{\isacharprime}{\isacharparenright}{\isachardot}\ stone{\isacharprime}\ {\isacharequal}\ stone{\isacharparenright}{\isacharparenright}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ i\ j{\isachardot}\ i\ {\isacharless}\ j\ {\isasymand}\ j\ {\isacharless}\ length\ {\isacharquery}ps\ {\isasymlongrightarrow}\ set\ {\isacharparenleft}filter\ {\isacharparenleft}{\isacharquery}ps\ {\isacharbang}\ i{\isacharparenright}\ {\isacharquery}ss{\isacharparenright}\ {\isasyminter}\ set\ {\isacharparenleft}filter\ {\isacharparenleft}{\isacharquery}ps\ {\isacharbang}\ j{\isacharparenright}\ {\isacharquery}ss{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ stone\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}{\isacharless}n{\isacharbrackright}{\isachardot}\ length\ {\isacharparenleft}{\isacharquery}sstone\ stone{\isacharparenright}{\isacharparenright}\ {\isasymle}\ length\ {\isacharquery}ss{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}length{\isacharunderscore}parts{\isacharbrackleft}of\ {\isacharquery}ps\ {\isacharquery}ss{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ comp{\isacharunderscore}def\ split{\isacharcolon}\ prod{\isachardot}split{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sum{\isacharunderscore}list{\isacharunderscore}int{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymSum}\ k\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}n{\isacharplus}{\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharparenleft}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ k{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}\ {\isasymle}\ length\ {\isacharquery}ss\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharquery}ss\ {\isacharplus}\ {\isadigit{1}}\ {\isacharequal}\ length\ l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}l{\isacharunderscore}states\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Valid game length%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{theorem}\isamarkupfalse%
\ IMO{\isadigit{2}}{\isadigit{0}}{\isadigit{1}}{\isadigit{8}}SL{\isacharunderscore}C{\isadigit{3}}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}valid{\isacharunderscore}game\ n\ states{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ states\ {\isasymge}\ {\isacharparenleft}{\isasymSum}\ k\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{1}}{\isachardot}{\isachardot}{\isacharless}n{\isacharplus}{\isadigit{1}}{\isacharbrackright}{\isachardot}\ {\isacharparenleft}ceiling\ {\isacharparenleft}n\ {\isacharslash}\ k{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l{\isacharunderscore}states\ {\isacharequal}\ {\isachardoublequoteopen}label{\isacharunderscore}moves{\isacharunderscore}max{\isacharunderscore}stone\ {\isacharparenleft}initial{\isacharunderscore}labeled{\isacharunderscore}state\ n{\isacharparenright}\ {\isacharparenleft}tl\ states{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharquery}l{\isacharunderscore}states\ {\isacharequal}\ length\ states{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ valid{\isacharunderscore}game{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone\ n\ {\isacharquery}l{\isacharunderscore}states{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ valid{\isacharunderscore}labeled{\isacharunderscore}game{\isacharunderscore}max{\isacharunderscore}stone{\isacharunderscore}min{\isacharunderscore}length{\isacharbrackleft}of\ n\ {\isacharquery}l{\isacharunderscore}states{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/git/IMO/IMO_files/solutions/IMO_2018_SL_C3.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%44=7%:%
%:%54=9%:%
%:%55=9%:%
%:%56=10%:%
%:%57=11%:%
%:%60=12%:%
%:%64=12%:%
%:%65=12%:%
%:%70=12%:%
%:%73=13%:%
%:%74=14%:%
%:%75=14%:%
%:%76=15%:%
%:%79=16%:%
%:%83=16%:%
%:%84=16%:%
%:%89=16%:%
%:%92=17%:%
%:%93=18%:%
%:%94=18%:%
%:%95=19%:%
%:%96=20%:%
%:%99=21%:%
%:%103=21%:%
%:%104=21%:%
%:%105=22%:%
%:%106=22%:%
%:%111=22%:%
%:%114=23%:%
%:%115=24%:%
%:%116=24%:%
%:%117=25%:%
%:%118=26%:%
%:%119=27%:%
%:%122=28%:%
%:%126=28%:%
%:%127=28%:%
%:%128=29%:%
%:%129=29%:%
%:%134=29%:%
%:%137=30%:%
%:%138=31%:%
%:%139=31%:%
%:%140=32%:%
%:%141=33%:%
%:%148=34%:%
%:%149=34%:%
%:%150=35%:%
%:%151=35%:%
%:%152=36%:%
%:%153=36%:%
%:%154=37%:%
%:%155=37%:%
%:%156=38%:%
%:%157=38%:%
%:%158=38%:%
%:%159=39%:%
%:%160=39%:%
%:%161=40%:%
%:%162=40%:%
%:%163=41%:%
%:%164=41%:%
%:%165=42%:%
%:%166=42%:%
%:%167=43%:%
%:%173=43%:%
%:%176=44%:%
%:%177=45%:%
%:%178=45%:%
%:%179=46%:%
%:%180=47%:%
%:%183=48%:%
%:%187=48%:%
%:%188=48%:%
%:%189=49%:%
%:%190=49%:%
%:%191=50%:%
%:%192=50%:%
%:%193=51%:%
%:%194=51%:%
%:%195=52%:%
%:%196=52%:%
%:%197=53%:%
%:%198=53%:%
%:%199=54%:%
%:%200=54%:%
%:%201=55%:%
%:%202=55%:%
%:%203=56%:%
%:%204=56%:%
%:%205=57%:%
%:%206=57%:%
%:%207=58%:%
%:%208=58%:%
%:%209=59%:%
%:%210=59%:%
%:%211=60%:%
%:%212=60%:%
%:%213=61%:%
%:%214=61%:%
%:%215=62%:%
%:%216=62%:%
%:%217=63%:%
%:%218=63%:%
%:%219=64%:%
%:%220=64%:%
%:%221=65%:%
%:%222=65%:%
%:%223=66%:%
%:%224=66%:%
%:%225=67%:%
%:%226=67%:%
%:%227=68%:%
%:%228=68%:%
%:%229=69%:%
%:%230=69%:%
%:%231=70%:%
%:%232=70%:%
%:%233=71%:%
%:%234=71%:%
%:%235=72%:%
%:%236=72%:%
%:%237=73%:%
%:%238=73%:%
%:%239=74%:%
%:%240=74%:%
%:%241=75%:%
%:%242=75%:%
%:%243=76%:%
%:%244=76%:%
%:%245=77%:%
%:%246=77%:%
%:%247=77%:%
%:%248=78%:%
%:%249=78%:%
%:%250=79%:%
%:%251=79%:%
%:%252=80%:%
%:%253=80%:%
%:%254=81%:%
%:%255=81%:%
%:%256=82%:%
%:%257=82%:%
%:%258=83%:%
%:%259=83%:%
%:%260=84%:%
%:%261=84%:%
%:%262=85%:%
%:%263=85%:%
%:%264=86%:%
%:%265=86%:%
%:%266=87%:%
%:%267=87%:%
%:%268=88%:%
%:%269=88%:%
%:%270=89%:%
%:%271=89%:%
%:%272=90%:%
%:%273=90%:%
%:%274=91%:%
%:%275=91%:%
%:%276=92%:%
%:%277=92%:%
%:%278=93%:%
%:%279=94%:%
%:%280=94%:%
%:%281=95%:%
%:%282=95%:%
%:%283=96%:%
%:%284=96%:%
%:%285=97%:%
%:%286=97%:%
%:%287=98%:%
%:%288=99%:%
%:%289=99%:%
%:%290=100%:%
%:%291=101%:%
%:%292=101%:%
%:%293=102%:%
%:%294=102%:%
%:%295=103%:%
%:%301=103%:%
%:%304=104%:%
%:%305=105%:%
%:%306=106%:%
%:%307=106%:%
%:%308=107%:%
%:%309=108%:%
%:%312=109%:%
%:%316=109%:%
%:%317=109%:%
%:%318=110%:%
%:%319=110%:%
%:%320=111%:%
%:%321=111%:%
%:%322=112%:%
%:%323=112%:%
%:%324=113%:%
%:%325=113%:%
%:%326=114%:%
%:%327=114%:%
%:%328=115%:%
%:%329=115%:%
%:%330=116%:%
%:%331=116%:%
%:%332=117%:%
%:%333=117%:%
%:%334=118%:%
%:%335=118%:%
%:%336=119%:%
%:%337=119%:%
%:%338=120%:%
%:%339=120%:%
%:%340=121%:%
%:%341=121%:%
%:%342=122%:%
%:%343=122%:%
%:%344=123%:%
%:%345=123%:%
%:%346=123%:%
%:%347=124%:%
%:%348=124%:%
%:%349=125%:%
%:%350=125%:%
%:%351=126%:%
%:%352=126%:%
%:%353=127%:%
%:%354=127%:%
%:%355=128%:%
%:%356=128%:%
%:%357=129%:%
%:%358=129%:%
%:%359=130%:%
%:%365=130%:%
%:%368=131%:%
%:%369=132%:%
%:%370=132%:%
%:%371=133%:%
%:%372=134%:%
%:%379=135%:%
%:%380=135%:%
%:%381=136%:%
%:%382=136%:%
%:%383=137%:%
%:%384=137%:%
%:%385=138%:%
%:%386=138%:%
%:%387=139%:%
%:%388=139%:%
%:%389=139%:%
%:%390=140%:%
%:%391=140%:%
%:%392=141%:%
%:%393=141%:%
%:%394=142%:%
%:%395=142%:%
%:%396=143%:%
%:%397=143%:%
%:%398=144%:%
%:%399=144%:%
%:%400=145%:%
%:%401=145%:%
%:%402=146%:%
%:%403=146%:%
%:%404=147%:%
%:%405=147%:%
%:%406=148%:%
%:%407=148%:%
%:%408=149%:%
%:%409=149%:%
%:%410=150%:%
%:%411=150%:%
%:%412=151%:%
%:%413=151%:%
%:%414=152%:%
%:%415=152%:%
%:%416=153%:%
%:%417=153%:%
%:%418=154%:%
%:%419=154%:%
%:%420=155%:%
%:%421=155%:%
%:%422=156%:%
%:%423=156%:%
%:%424=157%:%
%:%425=157%:%
%:%426=158%:%
%:%427=158%:%
%:%428=159%:%
%:%429=159%:%
%:%430=160%:%
%:%431=160%:%
%:%432=161%:%
%:%433=161%:%
%:%434=162%:%
%:%440=162%:%
%:%443=163%:%
%:%444=164%:%
%:%445=164%:%
%:%446=165%:%
%:%449=166%:%
%:%453=166%:%
%:%454=166%:%
%:%459=166%:%
%:%462=167%:%
%:%463=168%:%
%:%464=168%:%
%:%465=169%:%
%:%468=170%:%
%:%472=170%:%
%:%473=170%:%
%:%478=170%:%
%:%481=171%:%
%:%482=172%:%
%:%483=172%:%
%:%484=173%:%
%:%485=174%:%
%:%489=178%:%
%:%492=179%:%
%:%496=179%:%
%:%497=179%:%
%:%498=180%:%
%:%499=180%:%
%:%500=181%:%
%:%501=181%:%
%:%502=182%:%
%:%503=182%:%
%:%504=182%:%
%:%505=183%:%
%:%506=183%:%
%:%507=184%:%
%:%508=184%:%
%:%509=185%:%
%:%510=185%:%
%:%511=186%:%
%:%512=186%:%
%:%513=187%:%
%:%514=187%:%
%:%515=188%:%
%:%516=188%:%
%:%517=189%:%
%:%518=189%:%
%:%519=190%:%
%:%520=190%:%
%:%521=191%:%
%:%522=191%:%
%:%523=192%:%
%:%524=192%:%
%:%525=193%:%
%:%526=193%:%
%:%527=194%:%
%:%528=194%:%
%:%529=195%:%
%:%530=195%:%
%:%531=196%:%
%:%532=196%:%
%:%533=197%:%
%:%534=197%:%
%:%535=198%:%
%:%536=198%:%
%:%537=199%:%
%:%538=199%:%
%:%539=200%:%
%:%540=200%:%
%:%541=201%:%
%:%542=201%:%
%:%543=202%:%
%:%544=202%:%
%:%545=202%:%
%:%546=203%:%
%:%547=203%:%
%:%548=204%:%
%:%549=204%:%
%:%550=205%:%
%:%551=205%:%
%:%552=205%:%
%:%553=206%:%
%:%554=206%:%
%:%555=207%:%
%:%556=207%:%
%:%557=208%:%
%:%558=208%:%
%:%559=209%:%
%:%560=209%:%
%:%561=210%:%
%:%562=210%:%
%:%563=211%:%
%:%564=211%:%
%:%565=212%:%
%:%566=212%:%
%:%567=213%:%
%:%568=213%:%
%:%569=214%:%
%:%570=214%:%
%:%571=215%:%
%:%572=215%:%
%:%573=216%:%
%:%574=216%:%
%:%575=217%:%
%:%576=217%:%
%:%577=218%:%
%:%578=218%:%
%:%579=219%:%
%:%580=219%:%
%:%581=220%:%
%:%582=220%:%
%:%583=221%:%
%:%584=221%:%
%:%585=222%:%
%:%586=222%:%
%:%587=223%:%
%:%588=223%:%
%:%589=224%:%
%:%590=224%:%
%:%591=225%:%
%:%592=225%:%
%:%593=225%:%
%:%594=226%:%
%:%595=226%:%
%:%596=227%:%
%:%597=227%:%
%:%598=228%:%
%:%599=228%:%
%:%600=229%:%
%:%601=229%:%
%:%602=230%:%
%:%603=230%:%
%:%604=231%:%
%:%605=231%:%
%:%606=232%:%
%:%607=232%:%
%:%608=233%:%
%:%609=233%:%
%:%610=234%:%
%:%611=234%:%
%:%612=235%:%
%:%613=235%:%
%:%614=236%:%
%:%615=236%:%
%:%616=237%:%
%:%617=237%:%
%:%618=238%:%
%:%619=238%:%
%:%620=239%:%
%:%621=239%:%
%:%622=240%:%
%:%623=240%:%
%:%624=241%:%
%:%625=241%:%
%:%626=242%:%
%:%627=242%:%
%:%628=243%:%
%:%629=243%:%
%:%630=244%:%
%:%631=244%:%
%:%632=245%:%
%:%633=246%:%
%:%634=246%:%
%:%635=247%:%
%:%636=247%:%
%:%637=248%:%
%:%638=248%:%
%:%639=249%:%
%:%640=250%:%
%:%641=250%:%
%:%642=251%:%
%:%643=251%:%
%:%644=252%:%
%:%645=253%:%
%:%646=253%:%
%:%647=254%:%
%:%648=254%:%
%:%649=255%:%
%:%650=255%:%
%:%651=256%:%
%:%652=256%:%
%:%653=256%:%
%:%654=257%:%
%:%655=258%:%
%:%656=259%:%
%:%657=260%:%
%:%658=261%:%
%:%659=262%:%
%:%660=263%:%
%:%661=263%:%
%:%662=264%:%
%:%663=264%:%
%:%664=265%:%
%:%665=265%:%
%:%666=266%:%
%:%667=266%:%
%:%668=267%:%
%:%669=267%:%
%:%670=268%:%
%:%671=268%:%
%:%672=269%:%
%:%673=269%:%
%:%674=270%:%
%:%675=270%:%
%:%676=271%:%
%:%677=271%:%
%:%678=272%:%
%:%679=272%:%
%:%680=273%:%
%:%681=273%:%
%:%682=274%:%
%:%683=274%:%
%:%684=274%:%
%:%685=275%:%
%:%686=275%:%
%:%687=276%:%
%:%688=276%:%
%:%689=277%:%
%:%690=277%:%
%:%691=278%:%
%:%692=278%:%
%:%693=279%:%
%:%694=279%:%
%:%695=280%:%
%:%696=280%:%
%:%697=281%:%
%:%698=281%:%
%:%699=282%:%
%:%700=282%:%
%:%701=283%:%
%:%702=283%:%
%:%703=284%:%
%:%704=284%:%
%:%705=285%:%
%:%706=285%:%
%:%707=286%:%
%:%708=286%:%
%:%709=287%:%
%:%710=287%:%
%:%711=288%:%
%:%712=288%:%
%:%713=288%:%
%:%714=289%:%
%:%715=289%:%
%:%716=290%:%
%:%717=290%:%
%:%718=291%:%
%:%719=291%:%
%:%720=292%:%
%:%721=292%:%
%:%722=293%:%
%:%723=293%:%
%:%724=294%:%
%:%725=294%:%
%:%726=295%:%
%:%727=295%:%
%:%728=295%:%
%:%729=296%:%
%:%730=296%:%
%:%731=297%:%
%:%732=297%:%
%:%733=298%:%
%:%734=298%:%
%:%735=299%:%
%:%736=299%:%
%:%737=300%:%
%:%738=300%:%
%:%739=301%:%
%:%740=301%:%
%:%741=302%:%
%:%742=302%:%
%:%743=303%:%
%:%744=303%:%
%:%745=304%:%
%:%746=304%:%
%:%747=305%:%
%:%748=305%:%
%:%749=306%:%
%:%750=306%:%
%:%751=307%:%
%:%752=307%:%
%:%753=307%:%
%:%754=308%:%
%:%755=308%:%
%:%756=309%:%
%:%757=309%:%
%:%758=310%:%
%:%759=310%:%
%:%760=311%:%
%:%761=311%:%
%:%762=312%:%
%:%763=312%:%
%:%764=313%:%
%:%765=313%:%
%:%766=314%:%
%:%767=314%:%
%:%768=315%:%
%:%769=315%:%
%:%770=316%:%
%:%771=316%:%
%:%772=317%:%
%:%773=317%:%
%:%774=318%:%
%:%775=318%:%
%:%776=319%:%
%:%777=319%:%
%:%778=320%:%
%:%779=320%:%
%:%780=321%:%
%:%781=321%:%
%:%782=321%:%
%:%783=322%:%
%:%784=322%:%
%:%785=323%:%
%:%786=323%:%
%:%787=324%:%
%:%788=324%:%
%:%789=325%:%
%:%790=325%:%
%:%791=326%:%
%:%792=326%:%
%:%793=327%:%
%:%794=327%:%
%:%795=328%:%
%:%796=328%:%
%:%797=329%:%
%:%798=329%:%
%:%799=330%:%
%:%800=330%:%
%:%801=331%:%
%:%816=334%:%
%:%826=336%:%
%:%827=336%:%
%:%828=337%:%
%:%829=338%:%
%:%830=338%:%
%:%831=339%:%
%:%832=340%:%
%:%833=341%:%
%:%834=341%:%
%:%835=342%:%
%:%836=343%:%
%:%837=344%:%
%:%838=344%:%
%:%839=345%:%
%:%840=346%:%
%:%841=347%:%
%:%842=347%:%
%:%843=348%:%
%:%846=351%:%
%:%847=352%:%
%:%848=353%:%
%:%849=353%:%
%:%850=354%:%
%:%853=357%:%
%:%854=358%:%
%:%855=359%:%
%:%856=359%:%
%:%857=360%:%
%:%858=361%:%
%:%859=362%:%
%:%860=363%:%
%:%861=363%:%
%:%862=364%:%
%:%863=365%:%
%:%864=366%:%
%:%865=367%:%
%:%866=367%:%
%:%867=368%:%
%:%871=372%:%
%:%872=373%:%
%:%873=374%:%
%:%874=375%:%
%:%875=375%:%
%:%876=376%:%
%:%879=377%:%
%:%883=377%:%
%:%884=377%:%
%:%889=377%:%
%:%892=378%:%
%:%893=379%:%
%:%894=379%:%
%:%895=380%:%
%:%896=381%:%
%:%903=382%:%
%:%904=382%:%
%:%905=383%:%
%:%906=383%:%
%:%907=384%:%
%:%908=385%:%
%:%909=385%:%
%:%910=386%:%
%:%911=386%:%
%:%912=387%:%
%:%913=387%:%
%:%914=388%:%
%:%915=388%:%
%:%916=388%:%
%:%917=389%:%
%:%918=389%:%
%:%919=390%:%
%:%920=390%:%
%:%921=391%:%
%:%922=391%:%
%:%923=392%:%
%:%924=392%:%
%:%925=393%:%
%:%926=393%:%
%:%927=394%:%
%:%928=394%:%
%:%929=395%:%
%:%930=395%:%
%:%931=396%:%
%:%932=396%:%
%:%933=397%:%
%:%934=397%:%
%:%935=398%:%
%:%936=398%:%
%:%937=399%:%
%:%938=399%:%
%:%939=400%:%
%:%945=400%:%
%:%948=401%:%
%:%949=402%:%
%:%950=402%:%
%:%951=403%:%
%:%954=404%:%
%:%958=404%:%
%:%959=404%:%
%:%964=404%:%
%:%967=405%:%
%:%968=406%:%
%:%969=406%:%
%:%970=407%:%
%:%973=408%:%
%:%977=408%:%
%:%978=408%:%
%:%983=408%:%
%:%986=409%:%
%:%987=410%:%
%:%988=410%:%
%:%989=411%:%
%:%990=412%:%
%:%993=413%:%
%:%997=413%:%
%:%998=413%:%
%:%999=414%:%
%:%1000=414%:%
%:%1005=414%:%
%:%1008=415%:%
%:%1009=416%:%
%:%1010=416%:%
%:%1011=417%:%
%:%1012=418%:%
%:%1015=419%:%
%:%1019=419%:%
%:%1020=419%:%
%:%1021=420%:%
%:%1022=420%:%
%:%1023=421%:%
%:%1024=421%:%
%:%1025=422%:%
%:%1026=422%:%
%:%1027=422%:%
%:%1028=423%:%
%:%1029=423%:%
%:%1030=424%:%
%:%1031=424%:%
%:%1032=425%:%
%:%1033=425%:%
%:%1034=426%:%
%:%1035=426%:%
%:%1036=426%:%
%:%1037=427%:%
%:%1038=427%:%
%:%1039=428%:%
%:%1045=428%:%
%:%1048=429%:%
%:%1049=430%:%
%:%1050=430%:%
%:%1051=431%:%
%:%1052=432%:%
%:%1055=433%:%
%:%1059=433%:%
%:%1060=433%:%
%:%1061=434%:%
%:%1062=434%:%
%:%1063=435%:%
%:%1064=435%:%
%:%1065=436%:%
%:%1066=436%:%
%:%1071=436%:%
%:%1074=437%:%
%:%1075=438%:%
%:%1076=438%:%
%:%1077=439%:%
%:%1078=440%:%
%:%1079=441%:%
%:%1080=442%:%
%:%1081=442%:%
%:%1082=443%:%
%:%1083=444%:%
%:%1090=445%:%
%:%1091=445%:%
%:%1092=446%:%
%:%1093=446%:%
%:%1094=447%:%
%:%1095=447%:%
%:%1096=448%:%
%:%1097=448%:%
%:%1098=449%:%
%:%1099=449%:%
%:%1100=450%:%
%:%1101=451%:%
%:%1102=451%:%
%:%1103=452%:%
%:%1104=452%:%
%:%1105=453%:%
%:%1106=453%:%
%:%1107=454%:%
%:%1108=454%:%
%:%1109=455%:%
%:%1110=455%:%
%:%1111=456%:%
%:%1112=456%:%
%:%1113=457%:%
%:%1114=457%:%
%:%1115=458%:%
%:%1116=459%:%
%:%1117=459%:%
%:%1118=460%:%
%:%1119=460%:%
%:%1120=461%:%
%:%1121=461%:%
%:%1122=462%:%
%:%1123=462%:%
%:%1124=463%:%
%:%1125=463%:%
%:%1126=464%:%
%:%1127=464%:%
%:%1128=465%:%
%:%1129=465%:%
%:%1130=466%:%
%:%1131=467%:%
%:%1132=467%:%
%:%1133=468%:%
%:%1134=468%:%
%:%1135=469%:%
%:%1136=469%:%
%:%1137=470%:%
%:%1138=470%:%
%:%1139=471%:%
%:%1140=471%:%
%:%1141=472%:%
%:%1142=472%:%
%:%1143=473%:%
%:%1144=473%:%
%:%1145=474%:%
%:%1146=474%:%
%:%1147=475%:%
%:%1148=475%:%
%:%1149=476%:%
%:%1150=476%:%
%:%1151=477%:%
%:%1152=477%:%
%:%1153=478%:%
%:%1154=478%:%
%:%1155=479%:%
%:%1156=479%:%
%:%1157=479%:%
%:%1158=480%:%
%:%1159=480%:%
%:%1160=481%:%
%:%1161=481%:%
%:%1162=481%:%
%:%1163=482%:%
%:%1164=482%:%
%:%1165=483%:%
%:%1166=483%:%
%:%1167=484%:%
%:%1168=484%:%
%:%1169=485%:%
%:%1170=485%:%
%:%1171=486%:%
%:%1177=486%:%
%:%1180=487%:%
%:%1181=488%:%
%:%1182=488%:%
%:%1183=489%:%
%:%1184=490%:%
%:%1191=491%:%
%:%1192=491%:%
%:%1193=492%:%
%:%1194=492%:%
%:%1195=493%:%
%:%1196=493%:%
%:%1197=494%:%
%:%1198=494%:%
%:%1199=495%:%
%:%1200=495%:%
%:%1201=496%:%
%:%1202=496%:%
%:%1203=497%:%
%:%1204=497%:%
%:%1205=498%:%
%:%1206=498%:%
%:%1207=499%:%
%:%1208=499%:%
%:%1209=500%:%
%:%1210=500%:%
%:%1211=501%:%
%:%1212=501%:%
%:%1213=502%:%
%:%1214=502%:%
%:%1215=503%:%
%:%1216=503%:%
%:%1217=504%:%
%:%1218=504%:%
%:%1219=505%:%
%:%1220=505%:%
%:%1221=506%:%
%:%1222=506%:%
%:%1223=506%:%
%:%1224=507%:%
%:%1225=507%:%
%:%1226=508%:%
%:%1227=508%:%
%:%1228=509%:%
%:%1234=509%:%
%:%1237=510%:%
%:%1238=511%:%
%:%1239=511%:%
%:%1240=512%:%
%:%1241=513%:%
%:%1242=514%:%
%:%1245=515%:%
%:%1249=515%:%
%:%1250=515%:%
%:%1251=516%:%
%:%1252=516%:%
%:%1266=518%:%
%:%1276=520%:%
%:%1277=520%:%
%:%1278=521%:%
%:%1279=522%:%
%:%1280=522%:%
%:%1281=523%:%
%:%1282=524%:%
%:%1283=525%:%
%:%1284=525%:%
%:%1285=526%:%
%:%1286=527%:%
%:%1287=528%:%
%:%1288=528%:%
%:%1289=529%:%
%:%1292=532%:%
%:%1293=533%:%
%:%1294=534%:%
%:%1295=534%:%
%:%1296=535%:%
%:%1299=538%:%
%:%1300=539%:%
%:%1301=540%:%
%:%1302=540%:%
%:%1303=541%:%
%:%1306=544%:%
%:%1307=545%:%
%:%1308=546%:%
%:%1309=546%:%
%:%1310=547%:%
%:%1311=548%:%
%:%1312=549%:%
%:%1313=550%:%
%:%1314=550%:%
%:%1315=551%:%
%:%1316=552%:%
%:%1317=553%:%
%:%1318=554%:%
%:%1319=554%:%
%:%1320=555%:%
%:%1324=559%:%
%:%1325=560%:%
%:%1326=561%:%
%:%1327=561%:%
%:%1328=562%:%
%:%1331=563%:%
%:%1335=563%:%
%:%1336=563%:%
%:%1337=564%:%
%:%1338=564%:%
%:%1343=564%:%
%:%1346=565%:%
%:%1347=566%:%
%:%1348=566%:%
%:%1349=567%:%
%:%1356=568%:%
%:%1357=568%:%
%:%1358=569%:%
%:%1359=569%:%
%:%1360=570%:%
%:%1361=570%:%
%:%1362=571%:%
%:%1363=571%:%
%:%1364=572%:%
%:%1365=572%:%
%:%1366=573%:%
%:%1367=573%:%
%:%1368=574%:%
%:%1374=574%:%
%:%1377=575%:%
%:%1378=576%:%
%:%1379=576%:%
%:%1380=577%:%
%:%1381=578%:%
%:%1388=579%:%
%:%1389=579%:%
%:%1390=580%:%
%:%1391=580%:%
%:%1392=580%:%
%:%1393=581%:%
%:%1394=582%:%
%:%1395=583%:%
%:%1396=583%:%
%:%1397=584%:%
%:%1398=584%:%
%:%1399=585%:%
%:%1400=586%:%
%:%1401=586%:%
%:%1402=586%:%
%:%1404=588%:%
%:%1405=589%:%
%:%1406=589%:%
%:%1407=590%:%
%:%1408=591%:%
%:%1409=591%:%
%:%1410=592%:%
%:%1411=592%:%
%:%1412=593%:%
%:%1413=593%:%
%:%1414=594%:%
%:%1415=594%:%
%:%1416=595%:%
%:%1417=596%:%
%:%1418=596%:%
%:%1419=597%:%
%:%1420=597%:%
%:%1421=598%:%
%:%1422=598%:%
%:%1423=599%:%
%:%1424=599%:%
%:%1425=600%:%
%:%1426=601%:%
%:%1427=601%:%
%:%1428=602%:%
%:%1429=602%:%
%:%1430=603%:%
%:%1431=603%:%
%:%1432=604%:%
%:%1433=604%:%
%:%1434=605%:%
%:%1435=605%:%
%:%1436=605%:%
%:%1437=606%:%
%:%1438=606%:%
%:%1439=607%:%
%:%1440=607%:%
%:%1441=608%:%
%:%1442=609%:%
%:%1443=609%:%
%:%1444=610%:%
%:%1445=610%:%
%:%1446=611%:%
%:%1447=611%:%
%:%1448=612%:%
%:%1449=612%:%
%:%1450=613%:%
%:%1451=613%:%
%:%1452=614%:%
%:%1453=614%:%
%:%1454=615%:%
%:%1455=615%:%
%:%1456=615%:%
%:%1457=616%:%
%:%1458=616%:%
%:%1459=617%:%
%:%1460=617%:%
%:%1461=618%:%
%:%1462=618%:%
%:%1463=619%:%
%:%1464=619%:%
%:%1465=620%:%
%:%1466=620%:%
%:%1467=621%:%
%:%1468=621%:%
%:%1469=622%:%
%:%1470=622%:%
%:%1471=623%:%
%:%1472=623%:%
%:%1473=624%:%
%:%1474=624%:%
%:%1475=625%:%
%:%1476=625%:%
%:%1477=626%:%
%:%1478=626%:%
%:%1479=627%:%
%:%1480=627%:%
%:%1481=628%:%
%:%1482=628%:%
%:%1483=629%:%
%:%1484=629%:%
%:%1485=630%:%
%:%1486=630%:%
%:%1487=631%:%
%:%1488=631%:%
%:%1489=632%:%
%:%1490=632%:%
%:%1491=632%:%
%:%1492=633%:%
%:%1493=633%:%
%:%1494=634%:%
%:%1495=634%:%
%:%1496=635%:%
%:%1497=635%:%
%:%1498=636%:%
%:%1499=636%:%
%:%1500=637%:%
%:%1501=638%:%
%:%1502=638%:%
%:%1503=639%:%
%:%1504=640%:%
%:%1505=640%:%
%:%1506=641%:%
%:%1507=641%:%
%:%1508=642%:%
%:%1509=642%:%
%:%1510=643%:%
%:%1511=643%:%
%:%1512=644%:%
%:%1513=644%:%
%:%1514=644%:%
%:%1515=645%:%
%:%1516=645%:%
%:%1517=646%:%
%:%1518=646%:%
%:%1519=647%:%
%:%1520=647%:%
%:%1521=648%:%
%:%1522=648%:%
%:%1523=649%:%
%:%1524=649%:%
%:%1525=650%:%
%:%1526=650%:%
%:%1527=651%:%
%:%1528=651%:%
%:%1529=652%:%
%:%1530=652%:%
%:%1531=653%:%
%:%1532=653%:%
%:%1533=654%:%
%:%1534=654%:%
%:%1535=655%:%
%:%1536=656%:%
%:%1537=656%:%
%:%1538=657%:%
%:%1539=658%:%
%:%1540=658%:%
%:%1541=659%:%
%:%1542=659%:%
%:%1543=660%:%
%:%1544=660%:%
%:%1545=661%:%
%:%1546=661%:%
%:%1547=662%:%
%:%1548=662%:%
%:%1549=663%:%
%:%1555=663%:%
%:%1558=664%:%
%:%1559=665%:%
%:%1560=665%:%
%:%1561=666%:%
%:%1562=667%:%
%:%1565=668%:%
%:%1569=668%:%
%:%1570=668%:%
%:%1571=669%:%
%:%1572=669%:%
%:%1573=670%:%
%:%1574=670%:%
%:%1575=671%:%
%:%1576=671%:%
%:%1577=671%:%
%:%1578=672%:%
%:%1579=672%:%
%:%1580=673%:%
%:%1581=673%:%
%:%1582=674%:%
%:%1583=674%:%
%:%1584=675%:%
%:%1585=675%:%
%:%1586=675%:%
%:%1587=676%:%
%:%1588=676%:%
%:%1589=677%:%
%:%1595=677%:%
%:%1598=678%:%
%:%1599=679%:%
%:%1600=679%:%
%:%1601=680%:%
%:%1602=681%:%
%:%1605=682%:%
%:%1609=682%:%
%:%1610=682%:%
%:%1611=683%:%
%:%1612=683%:%
%:%1613=684%:%
%:%1614=684%:%
%:%1615=685%:%
%:%1616=685%:%
%:%1621=685%:%
%:%1624=686%:%
%:%1625=687%:%
%:%1626=687%:%
%:%1627=688%:%
%:%1628=689%:%
%:%1629=690%:%
%:%1630=691%:%
%:%1631=691%:%
%:%1632=692%:%
%:%1633=693%:%
%:%1640=694%:%
%:%1641=694%:%
%:%1642=695%:%
%:%1643=695%:%
%:%1644=696%:%
%:%1645=696%:%
%:%1646=697%:%
%:%1647=697%:%
%:%1648=698%:%
%:%1649=698%:%
%:%1650=699%:%
%:%1651=699%:%
%:%1652=700%:%
%:%1653=700%:%
%:%1654=701%:%
%:%1655=701%:%
%:%1656=702%:%
%:%1657=702%:%
%:%1658=703%:%
%:%1659=703%:%
%:%1660=704%:%
%:%1661=704%:%
%:%1662=705%:%
%:%1663=705%:%
%:%1664=706%:%
%:%1665=706%:%
%:%1666=707%:%
%:%1667=707%:%
%:%1668=708%:%
%:%1669=708%:%
%:%1670=709%:%
%:%1671=709%:%
%:%1672=710%:%
%:%1673=710%:%
%:%1674=711%:%
%:%1675=711%:%
%:%1676=712%:%
%:%1677=712%:%
%:%1678=713%:%
%:%1679=714%:%
%:%1680=714%:%
%:%1681=715%:%
%:%1682=715%:%
%:%1683=716%:%
%:%1684=716%:%
%:%1685=717%:%
%:%1686=718%:%
%:%1687=718%:%
%:%1688=719%:%
%:%1689=720%:%
%:%1690=720%:%
%:%1691=721%:%
%:%1692=721%:%
%:%1693=722%:%
%:%1694=722%:%
%:%1695=723%:%
%:%1696=724%:%
%:%1697=724%:%
%:%1698=725%:%
%:%1699=725%:%
%:%1700=726%:%
%:%1701=726%:%
%:%1702=727%:%
%:%1703=728%:%
%:%1704=728%:%
%:%1705=729%:%
%:%1706=729%:%
%:%1707=730%:%
%:%1708=730%:%
%:%1709=731%:%
%:%1710=731%:%
%:%1711=732%:%
%:%1712=733%:%
%:%1713=733%:%
%:%1714=734%:%
%:%1715=734%:%
%:%1716=735%:%
%:%1717=735%:%
%:%1718=736%:%
%:%1719=736%:%
%:%1720=737%:%
%:%1721=737%:%
%:%1722=738%:%
%:%1723=739%:%
%:%1724=739%:%
%:%1725=740%:%
%:%1726=740%:%
%:%1727=740%:%
%:%1728=741%:%
%:%1729=741%:%
%:%1730=741%:%
%:%1731=742%:%
%:%1732=742%:%
%:%1733=743%:%
%:%1734=743%:%
%:%1735=744%:%
%:%1736=745%:%
%:%1737=745%:%
%:%1738=746%:%
%:%1739=746%:%
%:%1740=747%:%
%:%1741=747%:%
%:%1742=748%:%
%:%1743=748%:%
%:%1744=749%:%
%:%1745=749%:%
%:%1746=750%:%
%:%1747=751%:%
%:%1748=751%:%
%:%1749=751%:%
%:%1750=752%:%
%:%1751=752%:%
%:%1752=753%:%
%:%1753=753%:%
%:%1754=754%:%
%:%1755=754%:%
%:%1756=755%:%
%:%1762=755%:%
%:%1765=756%:%
%:%1766=757%:%
%:%1767=757%:%
%:%1768=758%:%
%:%1769=759%:%
%:%1772=760%:%
%:%1776=760%:%
%:%1777=760%:%
%:%1778=761%:%
%:%1779=761%:%
%:%1780=762%:%
%:%1781=762%:%
%:%1782=763%:%
%:%1783=763%:%
%:%1788=763%:%
%:%1791=764%:%
%:%1792=765%:%
%:%1793=765%:%
%:%1794=766%:%
%:%1795=767%:%
%:%1796=768%:%
%:%1799=769%:%
%:%1803=769%:%
%:%1804=769%:%
%:%1805=770%:%
%:%1806=770%:%
%:%1811=770%:%
%:%1814=771%:%
%:%1815=772%:%
%:%1816=772%:%
%:%1817=773%:%
%:%1818=774%:%
%:%1819=775%:%
%:%1820=776%:%
%:%1821=776%:%
%:%1822=777%:%
%:%1823=778%:%
%:%1830=779%:%
%:%1831=779%:%
%:%1832=780%:%
%:%1833=780%:%
%:%1834=780%:%
%:%1835=781%:%
%:%1836=781%:%
%:%1837=782%:%
%:%1838=782%:%
%:%1839=783%:%
%:%1840=783%:%
%:%1841=783%:%
%:%1842=784%:%
%:%1843=784%:%
%:%1844=785%:%
%:%1845=785%:%
%:%1846=785%:%
%:%1847=786%:%
%:%1848=786%:%
%:%1849=787%:%
%:%1850=787%:%
%:%1851=788%:%
%:%1852=788%:%
%:%1853=789%:%
%:%1854=789%:%
%:%1855=790%:%
%:%1856=790%:%
%:%1857=791%:%
%:%1858=791%:%
%:%1859=792%:%
%:%1865=792%:%
%:%1868=793%:%
%:%1869=794%:%
%:%1870=794%:%
%:%1871=795%:%
%:%1872=796%:%
%:%1873=797%:%
%:%1876=798%:%
%:%1880=798%:%
%:%1881=798%:%
%:%1882=799%:%
%:%1883=799%:%
%:%1884=800%:%
%:%1885=800%:%
%:%1886=801%:%
%:%1887=801%:%
%:%1892=801%:%
%:%1895=802%:%
%:%1896=803%:%
%:%1897=803%:%
%:%1898=804%:%
%:%1899=805%:%
%:%1900=806%:%
%:%1903=807%:%
%:%1907=807%:%
%:%1908=807%:%
%:%1909=808%:%
%:%1910=808%:%
%:%1911=809%:%
%:%1912=809%:%
%:%1917=809%:%
%:%1920=810%:%
%:%1921=811%:%
%:%1922=811%:%
%:%1923=812%:%
%:%1924=813%:%
%:%1931=814%:%
%:%1932=814%:%
%:%1933=815%:%
%:%1934=815%:%
%:%1935=816%:%
%:%1936=816%:%
%:%1937=817%:%
%:%1938=817%:%
%:%1939=818%:%
%:%1940=818%:%
%:%1941=819%:%
%:%1942=819%:%
%:%1943=820%:%
%:%1944=820%:%
%:%1945=821%:%
%:%1946=821%:%
%:%1947=822%:%
%:%1948=822%:%
%:%1949=823%:%
%:%1950=823%:%
%:%1951=824%:%
%:%1952=824%:%
%:%1953=825%:%
%:%1954=825%:%
%:%1955=826%:%
%:%1956=826%:%
%:%1957=827%:%
%:%1958=827%:%
%:%1959=828%:%
%:%1960=828%:%
%:%1961=829%:%
%:%1962=829%:%
%:%1963=830%:%
%:%1964=830%:%
%:%1965=831%:%
%:%1966=831%:%
%:%1967=832%:%
%:%1968=832%:%
%:%1969=833%:%
%:%1970=833%:%
%:%1971=834%:%
%:%1977=834%:%
%:%1980=835%:%
%:%1981=836%:%
%:%1982=836%:%
%:%1983=837%:%
%:%1984=838%:%
%:%1985=839%:%
%:%1992=840%:%
%:%1993=840%:%
%:%1994=841%:%
%:%1995=841%:%
%:%1996=842%:%
%:%1997=842%:%
%:%1998=843%:%
%:%1999=843%:%
%:%2000=844%:%
%:%2001=844%:%
%:%2002=845%:%
%:%2003=845%:%
%:%2004=846%:%
%:%2005=846%:%
%:%2006=847%:%
%:%2007=847%:%
%:%2008=848%:%
%:%2009=848%:%
%:%2010=849%:%
%:%2011=849%:%
%:%2012=850%:%
%:%2013=850%:%
%:%2014=851%:%
%:%2015=851%:%
%:%2016=852%:%
%:%2017=852%:%
%:%2018=853%:%
%:%2019=853%:%
%:%2020=854%:%
%:%2021=854%:%
%:%2022=855%:%
%:%2023=855%:%
%:%2024=856%:%
%:%2025=856%:%
%:%2026=857%:%
%:%2027=857%:%
%:%2028=858%:%
%:%2029=858%:%
%:%2030=859%:%
%:%2031=859%:%
%:%2032=860%:%
%:%2033=860%:%
%:%2034=861%:%
%:%2035=862%:%
%:%2036=862%:%
%:%2037=863%:%
%:%2038=863%:%
%:%2039=864%:%
%:%2040=864%:%
%:%2041=865%:%
%:%2042=865%:%
%:%2043=866%:%
%:%2044=866%:%
%:%2045=867%:%
%:%2046=867%:%
%:%2047=868%:%
%:%2048=868%:%
%:%2049=869%:%
%:%2050=869%:%
%:%2051=870%:%
%:%2052=870%:%
%:%2053=871%:%
%:%2068=873%:%
%:%2078=875%:%
%:%2079=875%:%
%:%2080=876%:%
%:%2081=877%:%
%:%2082=878%:%
%:%2083=878%:%
%:%2084=879%:%
%:%2087=880%:%
%:%2091=880%:%
%:%2092=880%:%
%:%2093=881%:%
%:%2094=881%:%
%:%2099=881%:%
%:%2102=882%:%
%:%2103=883%:%
%:%2104=883%:%
%:%2105=884%:%
%:%2108=885%:%
%:%2112=885%:%
%:%2113=885%:%
%:%2114=886%:%
%:%2115=886%:%
%:%2120=886%:%
%:%2123=887%:%
%:%2124=888%:%
%:%2125=888%:%
%:%2126=889%:%
%:%2127=890%:%
%:%2130=891%:%
%:%2134=891%:%
%:%2135=891%:%
%:%2136=892%:%
%:%2137=892%:%
%:%2138=893%:%
%:%2139=893%:%
%:%2140=894%:%
%:%2141=894%:%
%:%2142=895%:%
%:%2143=895%:%
%:%2144=896%:%
%:%2145=896%:%
%:%2146=897%:%
%:%2147=898%:%
%:%2148=898%:%
%:%2149=899%:%
%:%2150=899%:%
%:%2151=900%:%
%:%2152=900%:%
%:%2153=901%:%
%:%2154=902%:%
%:%2155=902%:%
%:%2156=903%:%
%:%2157=903%:%
%:%2158=904%:%
%:%2159=904%:%
%:%2160=904%:%
%:%2161=905%:%
%:%2162=905%:%
%:%2163=906%:%
%:%2164=906%:%
%:%2165=907%:%
%:%2166=907%:%
%:%2167=908%:%
%:%2168=908%:%
%:%2169=909%:%
%:%2170=909%:%
%:%2171=910%:%
%:%2172=910%:%
%:%2173=910%:%
%:%2174=911%:%
%:%2175=911%:%
%:%2176=912%:%
%:%2177=912%:%
%:%2178=913%:%
%:%2179=913%:%
%:%2180=913%:%
%:%2181=914%:%
%:%2182=914%:%
%:%2183=915%:%
%:%2184=915%:%
%:%2185=916%:%
%:%2186=916%:%
%:%2187=917%:%
%:%2188=917%:%
%:%2189=918%:%
%:%2190=918%:%
%:%2191=919%:%
%:%2192=919%:%
%:%2193=920%:%
%:%2194=920%:%
%:%2195=921%:%
%:%2196=921%:%
%:%2197=922%:%
%:%2198=922%:%
%:%2199=923%:%
%:%2200=923%:%
%:%2201=924%:%
%:%2202=924%:%
%:%2203=925%:%
%:%2204=925%:%
%:%2205=926%:%
%:%2206=926%:%
%:%2207=927%:%
%:%2208=927%:%
%:%2209=928%:%
%:%2210=928%:%
%:%2211=929%:%
%:%2212=929%:%
%:%2213=930%:%
%:%2214=930%:%
%:%2215=931%:%
%:%2216=931%:%
%:%2217=932%:%
%:%2218=932%:%
%:%2219=933%:%
%:%2220=933%:%
%:%2221=934%:%
%:%2222=934%:%
%:%2223=935%:%
%:%2224=935%:%
%:%2225=936%:%
%:%2226=936%:%
%:%2227=937%:%
%:%2228=937%:%
%:%2229=937%:%
%:%2230=938%:%
%:%2231=938%:%
%:%2232=939%:%
%:%2233=939%:%
%:%2234=939%:%
%:%2235=940%:%
%:%2236=940%:%
%:%2237=941%:%
%:%2238=941%:%
%:%2239=942%:%
%:%2240=942%:%
%:%2241=943%:%
%:%2242=943%:%
%:%2243=944%:%
%:%2244=944%:%
%:%2245=945%:%
%:%2246=945%:%
%:%2247=946%:%
%:%2248=946%:%
%:%2249=947%:%
%:%2250=948%:%
%:%2251=948%:%
%:%2252=949%:%
%:%2253=949%:%
%:%2254=950%:%
%:%2255=950%:%
%:%2256=951%:%
%:%2257=951%:%
%:%2258=951%:%
%:%2259=952%:%
%:%2260=952%:%
%:%2261=953%:%
%:%2262=953%:%
%:%2263=954%:%
%:%2264=954%:%
%:%2265=955%:%
%:%2266=955%:%
%:%2267=955%:%
%:%2268=956%:%
%:%2269=956%:%
%:%2270=957%:%
%:%2271=957%:%
%:%2272=958%:%
%:%2273=958%:%
%:%2274=959%:%
%:%2275=959%:%
%:%2276=960%:%
%:%2277=960%:%
%:%2278=961%:%
%:%2279=961%:%
%:%2280=962%:%
%:%2281=962%:%
%:%2282=963%:%
%:%2283=963%:%
%:%2284=964%:%
%:%2285=964%:%
%:%2286=965%:%
%:%2287=965%:%
%:%2288=965%:%
%:%2289=966%:%
%:%2290=966%:%
%:%2291=967%:%
%:%2292=967%:%
%:%2293=968%:%
%:%2294=968%:%
%:%2295=969%:%
%:%2296=969%:%
%:%2297=970%:%
%:%2298=970%:%
%:%2299=971%:%
%:%2300=971%:%
%:%2301=972%:%
%:%2302=972%:%
%:%2303=973%:%
%:%2304=973%:%
%:%2305=974%:%
%:%2306=974%:%
%:%2307=975%:%
%:%2308=975%:%
%:%2309=976%:%
%:%2310=976%:%
%:%2311=977%:%
%:%2312=977%:%
%:%2313=978%:%
%:%2314=978%:%
%:%2315=979%:%
%:%2316=979%:%
%:%2317=980%:%
%:%2318=980%:%
%:%2319=981%:%
%:%2320=981%:%
%:%2321=982%:%
%:%2322=982%:%
%:%2323=983%:%
%:%2324=983%:%
%:%2325=984%:%
%:%2326=984%:%
%:%2327=985%:%
%:%2328=985%:%
%:%2329=986%:%
%:%2330=986%:%
%:%2331=987%:%
%:%2332=987%:%
%:%2333=988%:%
%:%2334=988%:%
%:%2335=989%:%
%:%2336=989%:%
%:%2337=990%:%
%:%2338=990%:%
%:%2339=991%:%
%:%2340=991%:%
%:%2341=992%:%
%:%2347=992%:%
%:%2350=993%:%
%:%2351=994%:%
%:%2352=994%:%
%:%2353=995%:%
%:%2354=996%:%
%:%2355=997%:%
%:%2362=998%:%
%:%2363=998%:%
%:%2364=999%:%
%:%2365=999%:%
%:%2366=999%:%
%:%2367=1000%:%
%:%2368=1001%:%
%:%2369=1002%:%
%:%2370=1002%:%
%:%2371=1003%:%
%:%2372=1003%:%
%:%2373=1004%:%
%:%2374=1005%:%
%:%2375=1005%:%
%:%2376=1006%:%
%:%2377=1006%:%
%:%2378=1007%:%
%:%2379=1007%:%
%:%2380=1008%:%
%:%2381=1008%:%
%:%2382=1009%:%
%:%2383=1010%:%
%:%2384=1010%:%
%:%2385=1011%:%
%:%2386=1011%:%
%:%2387=1012%:%
%:%2388=1012%:%
%:%2389=1013%:%
%:%2390=1013%:%
%:%2391=1014%:%
%:%2392=1015%:%
%:%2393=1015%:%
%:%2394=1016%:%
%:%2395=1017%:%
%:%2396=1018%:%
%:%2397=1018%:%
%:%2398=1019%:%
%:%2399=1019%:%
%:%2400=1020%:%
%:%2401=1020%:%
%:%2402=1021%:%
%:%2403=1021%:%
%:%2404=1022%:%
%:%2405=1022%:%
%:%2406=1023%:%
%:%2407=1024%:%
%:%2408=1024%:%
%:%2409=1025%:%
%:%2410=1025%:%
%:%2411=1026%:%
%:%2412=1026%:%
%:%2413=1027%:%
%:%2414=1027%:%
%:%2415=1028%:%
%:%2416=1028%:%
%:%2417=1029%:%
%:%2423=1029%:%
%:%2426=1030%:%
%:%2427=1031%:%
%:%2428=1031%:%
%:%2429=1032%:%
%:%2430=1033%:%
%:%2433=1034%:%
%:%2437=1034%:%
%:%2438=1034%:%
%:%2439=1035%:%
%:%2440=1035%:%
%:%2441=1036%:%
%:%2442=1036%:%
%:%2456=1039%:%
%:%2466=1041%:%
%:%2467=1041%:%
%:%2468=1042%:%
%:%2469=1043%:%
%:%2470=1044%:%
%:%2471=1045%:%
%:%2472=1045%:%
%:%2473=1046%:%
%:%2474=1047%:%
%:%2475=1048%:%
%:%2476=1049%:%
%:%2477=1049%:%
%:%2478=1050%:%
%:%2482=1054%:%
%:%2483=1055%:%
%:%2484=1056%:%
%:%2485=1056%:%
%:%2486=1057%:%
%:%2487=1058%:%
%:%2490=1059%:%
%:%2494=1059%:%
%:%2495=1059%:%
%:%2496=1060%:%
%:%2497=1060%:%
%:%2498=1061%:%
%:%2499=1061%:%
%:%2500=1062%:%
%:%2501=1062%:%
%:%2502=1063%:%
%:%2503=1063%:%
%:%2504=1064%:%
%:%2510=1064%:%
%:%2513=1065%:%
%:%2514=1066%:%
%:%2515=1066%:%
%:%2516=1067%:%
%:%2517=1068%:%
%:%2520=1069%:%
%:%2524=1069%:%
%:%2525=1069%:%
%:%2526=1070%:%
%:%2527=1070%:%
%:%2528=1071%:%
%:%2529=1071%:%
%:%2530=1072%:%
%:%2531=1072%:%
%:%2532=1073%:%
%:%2533=1073%:%
%:%2538=1073%:%
%:%2541=1074%:%
%:%2542=1075%:%
%:%2543=1075%:%
%:%2544=1076%:%
%:%2545=1077%:%
%:%2546=1078%:%
%:%2547=1079%:%
%:%2554=1080%:%
%:%2555=1080%:%
%:%2556=1081%:%
%:%2557=1081%:%
%:%2558=1082%:%
%:%2559=1082%:%
%:%2560=1083%:%
%:%2561=1083%:%
%:%2562=1084%:%
%:%2563=1084%:%
%:%2564=1085%:%
%:%2565=1085%:%
%:%2566=1086%:%
%:%2572=1086%:%
%:%2575=1087%:%
%:%2576=1088%:%
%:%2577=1088%:%
%:%2578=1089%:%
%:%2579=1090%:%
%:%2583=1094%:%
%:%2584=1095%:%
%:%2585=1096%:%
%:%2586=1096%:%
%:%2587=1097%:%
%:%2590=1098%:%
%:%2594=1098%:%
%:%2595=1098%:%
%:%2600=1098%:%
%:%2603=1099%:%
%:%2604=1100%:%
%:%2605=1100%:%
%:%2606=1101%:%
%:%2607=1102%:%
%:%2610=1103%:%
%:%2614=1103%:%
%:%2615=1103%:%
%:%2616=1104%:%
%:%2617=1104%:%
%:%2618=1105%:%
%:%2619=1105%:%
%:%2620=1106%:%
%:%2621=1106%:%
%:%2622=1106%:%
%:%2623=1107%:%
%:%2624=1107%:%
%:%2625=1108%:%
%:%2626=1108%:%
%:%2627=1109%:%
%:%2628=1109%:%
%:%2629=1110%:%
%:%2630=1110%:%
%:%2631=1111%:%
%:%2632=1111%:%
%:%2633=1112%:%
%:%2634=1112%:%
%:%2635=1113%:%
%:%2636=1113%:%
%:%2637=1114%:%
%:%2638=1114%:%
%:%2639=1115%:%
%:%2640=1115%:%
%:%2641=1116%:%
%:%2642=1117%:%
%:%2643=1117%:%
%:%2644=1118%:%
%:%2645=1118%:%
%:%2646=1119%:%
%:%2647=1119%:%
%:%2648=1120%:%
%:%2649=1121%:%
%:%2650=1121%:%
%:%2651=1122%:%
%:%2652=1122%:%
%:%2653=1123%:%
%:%2654=1123%:%
%:%2655=1124%:%
%:%2656=1125%:%
%:%2657=1125%:%
%:%2658=1126%:%
%:%2659=1126%:%
%:%2660=1127%:%
%:%2661=1127%:%
%:%2662=1128%:%
%:%2663=1129%:%
%:%2664=1129%:%
%:%2665=1130%:%
%:%2666=1130%:%
%:%2667=1131%:%
%:%2668=1131%:%
%:%2669=1132%:%
%:%2670=1132%:%
%:%2671=1133%:%
%:%2672=1133%:%
%:%2673=1134%:%
%:%2674=1134%:%
%:%2675=1135%:%
%:%2676=1135%:%
%:%2677=1136%:%
%:%2678=1136%:%
%:%2679=1137%:%
%:%2680=1137%:%
%:%2681=1138%:%
%:%2682=1138%:%
%:%2683=1139%:%
%:%2684=1139%:%
%:%2685=1140%:%
%:%2686=1141%:%
%:%2687=1141%:%
%:%2688=1142%:%
%:%2689=1142%:%
%:%2690=1143%:%
%:%2691=1143%:%
%:%2692=1144%:%
%:%2693=1144%:%
%:%2694=1145%:%
%:%2695=1145%:%
%:%2696=1145%:%
%:%2697=1146%:%
%:%2698=1146%:%
%:%2699=1147%:%
%:%2700=1147%:%
%:%2701=1148%:%
%:%2702=1149%:%
%:%2703=1149%:%
%:%2704=1150%:%
%:%2705=1150%:%
%:%2706=1151%:%
%:%2707=1151%:%
%:%2708=1152%:%
%:%2709=1152%:%
%:%2710=1153%:%
%:%2711=1153%:%
%:%2712=1154%:%
%:%2713=1154%:%
%:%2714=1155%:%
%:%2715=1155%:%
%:%2716=1155%:%
%:%2717=1156%:%
%:%2718=1156%:%
%:%2719=1157%:%
%:%2720=1157%:%
%:%2721=1158%:%
%:%2722=1158%:%
%:%2723=1159%:%
%:%2724=1159%:%
%:%2725=1160%:%
%:%2726=1160%:%
%:%2727=1161%:%
%:%2728=1161%:%
%:%2729=1162%:%
%:%2730=1162%:%
%:%2731=1163%:%
%:%2732=1163%:%
%:%2733=1164%:%
%:%2734=1164%:%
%:%2735=1165%:%
%:%2736=1165%:%
%:%2737=1165%:%
%:%2738=1166%:%
%:%2739=1166%:%
%:%2740=1167%:%
%:%2741=1167%:%
%:%2742=1168%:%
%:%2748=1168%:%
%:%2751=1169%:%
%:%2752=1170%:%
%:%2753=1170%:%
%:%2754=1171%:%
%:%2755=1172%:%
%:%2758=1173%:%
%:%2762=1173%:%
%:%2763=1173%:%
%:%2764=1174%:%
%:%2765=1174%:%
%:%2766=1175%:%
%:%2767=1175%:%
%:%2768=1176%:%
%:%2769=1176%:%
%:%2770=1176%:%
%:%2771=1177%:%
%:%2772=1177%:%
%:%2773=1178%:%
%:%2774=1178%:%
%:%2775=1179%:%
%:%2776=1179%:%
%:%2777=1180%:%
%:%2778=1180%:%
%:%2779=1181%:%
%:%2780=1181%:%
%:%2781=1182%:%
%:%2782=1182%:%
%:%2783=1183%:%
%:%2784=1183%:%
%:%2785=1184%:%
%:%2786=1184%:%
%:%2787=1185%:%
%:%2788=1185%:%
%:%2789=1186%:%
%:%2790=1187%:%
%:%2791=1187%:%
%:%2792=1188%:%
%:%2793=1188%:%
%:%2794=1189%:%
%:%2795=1189%:%
%:%2796=1190%:%
%:%2797=1191%:%
%:%2798=1191%:%
%:%2799=1192%:%
%:%2800=1192%:%
%:%2801=1193%:%
%:%2802=1193%:%
%:%2803=1194%:%
%:%2804=1195%:%
%:%2805=1195%:%
%:%2806=1196%:%
%:%2807=1196%:%
%:%2808=1197%:%
%:%2809=1197%:%
%:%2810=1198%:%
%:%2811=1199%:%
%:%2812=1199%:%
%:%2813=1200%:%
%:%2814=1200%:%
%:%2815=1201%:%
%:%2816=1201%:%
%:%2817=1202%:%
%:%2818=1202%:%
%:%2819=1203%:%
%:%2820=1203%:%
%:%2821=1204%:%
%:%2822=1204%:%
%:%2823=1205%:%
%:%2824=1205%:%
%:%2825=1206%:%
%:%2826=1206%:%
%:%2827=1207%:%
%:%2828=1207%:%
%:%2829=1208%:%
%:%2830=1208%:%
%:%2831=1209%:%
%:%2832=1209%:%
%:%2833=1210%:%
%:%2834=1211%:%
%:%2835=1211%:%
%:%2836=1212%:%
%:%2837=1212%:%
%:%2838=1213%:%
%:%2839=1213%:%
%:%2840=1214%:%
%:%2841=1214%:%
%:%2842=1215%:%
%:%2843=1215%:%
%:%2844=1215%:%
%:%2845=1216%:%
%:%2846=1216%:%
%:%2847=1217%:%
%:%2848=1217%:%
%:%2849=1218%:%
%:%2850=1219%:%
%:%2851=1219%:%
%:%2852=1220%:%
%:%2853=1220%:%
%:%2854=1221%:%
%:%2855=1221%:%
%:%2856=1222%:%
%:%2857=1222%:%
%:%2858=1223%:%
%:%2859=1223%:%
%:%2860=1224%:%
%:%2861=1224%:%
%:%2862=1225%:%
%:%2863=1225%:%
%:%2864=1226%:%
%:%2865=1226%:%
%:%2866=1227%:%
%:%2867=1227%:%
%:%2868=1228%:%
%:%2869=1228%:%
%:%2870=1229%:%
%:%2871=1229%:%
%:%2872=1230%:%
%:%2873=1230%:%
%:%2874=1230%:%
%:%2875=1231%:%
%:%2876=1231%:%
%:%2877=1232%:%
%:%2878=1232%:%
%:%2879=1233%:%
%:%2880=1233%:%
%:%2881=1234%:%
%:%2882=1234%:%
%:%2883=1235%:%
%:%2884=1235%:%
%:%2885=1235%:%
%:%2886=1236%:%
%:%2887=1236%:%
%:%2888=1237%:%
%:%2889=1237%:%
%:%2890=1238%:%
%:%2896=1238%:%
%:%2899=1239%:%
%:%2900=1240%:%
%:%2901=1240%:%
%:%2902=1241%:%
%:%2905=1242%:%
%:%2909=1242%:%
%:%2910=1242%:%
%:%2915=1242%:%
%:%2918=1243%:%
%:%2919=1244%:%
%:%2920=1244%:%
%:%2921=1245%:%
%:%2922=1246%:%
%:%2925=1247%:%
%:%2929=1247%:%
%:%2930=1247%:%
%:%2931=1248%:%
%:%2932=1248%:%
%:%2933=1249%:%
%:%2934=1249%:%
%:%2935=1250%:%
%:%2936=1250%:%
%:%2937=1250%:%
%:%2938=1251%:%
%:%2939=1251%:%
%:%2940=1252%:%
%:%2941=1252%:%
%:%2942=1253%:%
%:%2943=1253%:%
%:%2944=1254%:%
%:%2945=1254%:%
%:%2946=1255%:%
%:%2947=1255%:%
%:%2948=1256%:%
%:%2949=1256%:%
%:%2950=1257%:%
%:%2951=1257%:%
%:%2952=1258%:%
%:%2953=1258%:%
%:%2954=1259%:%
%:%2955=1259%:%
%:%2956=1260%:%
%:%2957=1261%:%
%:%2958=1261%:%
%:%2959=1262%:%
%:%2960=1262%:%
%:%2961=1263%:%
%:%2962=1263%:%
%:%2963=1264%:%
%:%2964=1265%:%
%:%2965=1265%:%
%:%2966=1266%:%
%:%2967=1266%:%
%:%2968=1267%:%
%:%2969=1267%:%
%:%2970=1268%:%
%:%2971=1269%:%
%:%2972=1269%:%
%:%2973=1270%:%
%:%2974=1270%:%
%:%2975=1271%:%
%:%2976=1271%:%
%:%2977=1272%:%
%:%2978=1273%:%
%:%2979=1273%:%
%:%2980=1274%:%
%:%2981=1274%:%
%:%2982=1275%:%
%:%2983=1275%:%
%:%2984=1276%:%
%:%2985=1276%:%
%:%2986=1277%:%
%:%2987=1277%:%
%:%2988=1278%:%
%:%2989=1278%:%
%:%2990=1279%:%
%:%2991=1279%:%
%:%2992=1280%:%
%:%2993=1280%:%
%:%2994=1281%:%
%:%2995=1281%:%
%:%2996=1282%:%
%:%2997=1282%:%
%:%2998=1283%:%
%:%2999=1283%:%
%:%3000=1284%:%
%:%3001=1285%:%
%:%3002=1285%:%
%:%3003=1286%:%
%:%3004=1286%:%
%:%3005=1287%:%
%:%3006=1287%:%
%:%3007=1288%:%
%:%3008=1288%:%
%:%3009=1289%:%
%:%3010=1289%:%
%:%3011=1289%:%
%:%3012=1290%:%
%:%3013=1290%:%
%:%3014=1291%:%
%:%3015=1291%:%
%:%3016=1292%:%
%:%3017=1293%:%
%:%3018=1293%:%
%:%3019=1294%:%
%:%3020=1294%:%
%:%3021=1295%:%
%:%3022=1295%:%
%:%3023=1296%:%
%:%3024=1296%:%
%:%3025=1297%:%
%:%3026=1298%:%
%:%3027=1298%:%
%:%3028=1299%:%
%:%3029=1299%:%
%:%3030=1300%:%
%:%3031=1300%:%
%:%3032=1301%:%
%:%3033=1301%:%
%:%3034=1302%:%
%:%3035=1302%:%
%:%3036=1303%:%
%:%3037=1303%:%
%:%3038=1304%:%
%:%3039=1304%:%
%:%3040=1305%:%
%:%3041=1305%:%
%:%3042=1306%:%
%:%3043=1306%:%
%:%3044=1307%:%
%:%3045=1307%:%
%:%3046=1308%:%
%:%3047=1308%:%
%:%3048=1308%:%
%:%3049=1309%:%
%:%3050=1309%:%
%:%3051=1310%:%
%:%3052=1310%:%
%:%3053=1311%:%
%:%3054=1311%:%
%:%3055=1312%:%
%:%3056=1312%:%
%:%3057=1313%:%
%:%3058=1313%:%
%:%3059=1314%:%
%:%3060=1314%:%
%:%3061=1315%:%
%:%3062=1315%:%
%:%3063=1315%:%
%:%3064=1316%:%
%:%3065=1316%:%
%:%3066=1317%:%
%:%3067=1317%:%
%:%3068=1318%:%
%:%3069=1318%:%
%:%3070=1319%:%
%:%3071=1319%:%
%:%3072=1320%:%
%:%3073=1320%:%
%:%3074=1321%:%
%:%3080=1321%:%
%:%3083=1322%:%
%:%3084=1323%:%
%:%3085=1323%:%
%:%3086=1324%:%
%:%3087=1325%:%
%:%3094=1326%:%
%:%3095=1326%:%
%:%3096=1327%:%
%:%3097=1327%:%
%:%3098=1328%:%
%:%3099=1328%:%
%:%3100=1329%:%
%:%3101=1329%:%
%:%3102=1330%:%
%:%3103=1330%:%
%:%3104=1331%:%
%:%3105=1331%:%
%:%3106=1332%:%
%:%3107=1332%:%
%:%3108=1333%:%
%:%3109=1333%:%
%:%3110=1334%:%
%:%3111=1334%:%
%:%3112=1335%:%
%:%3113=1335%:%
%:%3114=1336%:%
%:%3115=1336%:%
%:%3116=1337%:%
%:%3117=1337%:%
%:%3118=1338%:%
%:%3119=1338%:%
%:%3120=1339%:%
%:%3121=1339%:%
%:%3122=1340%:%
%:%3123=1340%:%
%:%3124=1341%:%
%:%3125=1341%:%
%:%3126=1342%:%
%:%3127=1342%:%
%:%3128=1343%:%
%:%3129=1343%:%
%:%3130=1344%:%
%:%3131=1344%:%
%:%3132=1345%:%
%:%3133=1345%:%
%:%3134=1346%:%
%:%3135=1346%:%
%:%3136=1347%:%
%:%3137=1347%:%
%:%3138=1348%:%
%:%3139=1348%:%
%:%3140=1349%:%
%:%3141=1349%:%
%:%3142=1350%:%
%:%3143=1350%:%
%:%3144=1351%:%
%:%3145=1351%:%
%:%3146=1352%:%
%:%3147=1352%:%
%:%3148=1353%:%
%:%3149=1353%:%
%:%3150=1354%:%
%:%3151=1354%:%
%:%3152=1355%:%
%:%3153=1355%:%
%:%3154=1356%:%
%:%3155=1356%:%
%:%3156=1357%:%
%:%3157=1357%:%
%:%3158=1358%:%
%:%3159=1358%:%
%:%3160=1359%:%
%:%3161=1359%:%
%:%3162=1360%:%
%:%3163=1360%:%
%:%3164=1361%:%
%:%3165=1361%:%
%:%3166=1362%:%
%:%3167=1362%:%
%:%3168=1363%:%
%:%3169=1363%:%
%:%3170=1364%:%
%:%3176=1364%:%
%:%3179=1365%:%
%:%3180=1366%:%
%:%3181=1366%:%
%:%3182=1367%:%
%:%3183=1368%:%
%:%3186=1369%:%
%:%3190=1369%:%
%:%3191=1369%:%
%:%3196=1369%:%
%:%3199=1370%:%
%:%3200=1371%:%
%:%3201=1371%:%
%:%3202=1372%:%
%:%3203=1373%:%
%:%3206=1374%:%
%:%3210=1374%:%
%:%3211=1374%:%
%:%3212=1375%:%
%:%3213=1375%:%
%:%3214=1376%:%
%:%3215=1376%:%
%:%3216=1377%:%
%:%3217=1377%:%
%:%3218=1378%:%
%:%3219=1378%:%
%:%3220=1379%:%
%:%3221=1379%:%
%:%3222=1380%:%
%:%3223=1380%:%
%:%3224=1381%:%
%:%3225=1381%:%
%:%3226=1382%:%
%:%3227=1382%:%
%:%3228=1383%:%
%:%3229=1384%:%
%:%3230=1384%:%
%:%3231=1385%:%
%:%3232=1385%:%
%:%3233=1386%:%
%:%3234=1386%:%
%:%3235=1387%:%
%:%3236=1387%:%
%:%3237=1388%:%
%:%3238=1388%:%
%:%3239=1389%:%
%:%3240=1390%:%
%:%3241=1390%:%
%:%3242=1391%:%
%:%3243=1391%:%
%:%3244=1392%:%
%:%3245=1392%:%
%:%3246=1393%:%
%:%3247=1393%:%
%:%3248=1394%:%
%:%3249=1394%:%
%:%3250=1395%:%
%:%3251=1395%:%
%:%3252=1396%:%
%:%3253=1396%:%
%:%3254=1397%:%
%:%3255=1397%:%
%:%3256=1398%:%
%:%3257=1398%:%
%:%3258=1399%:%
%:%3259=1399%:%
%:%3260=1400%:%
%:%3261=1400%:%
%:%3262=1401%:%
%:%3263=1401%:%
%:%3264=1402%:%
%:%3265=1403%:%
%:%3266=1403%:%
%:%3267=1404%:%
%:%3268=1404%:%
%:%3269=1405%:%
%:%3270=1405%:%
%:%3271=1406%:%
%:%3272=1406%:%
%:%3273=1407%:%
%:%3274=1407%:%
%:%3275=1408%:%
%:%3276=1408%:%
%:%3277=1409%:%
%:%3278=1409%:%
%:%3279=1410%:%
%:%3280=1410%:%
%:%3281=1411%:%
%:%3282=1411%:%
%:%3283=1412%:%
%:%3284=1412%:%
%:%3285=1413%:%
%:%3286=1413%:%
%:%3287=1414%:%
%:%3288=1414%:%
%:%3289=1415%:%
%:%3290=1415%:%
%:%3291=1416%:%
%:%3306=1418%:%
%:%3316=1420%:%
%:%3317=1420%:%
%:%3318=1421%:%
%:%3319=1422%:%
%:%3320=1423%:%
%:%3321=1424%:%
%:%3323=1426%:%
%:%3326=1427%:%
%:%3330=1427%:%
%:%3331=1427%:%
%:%3332=1428%:%
%:%3333=1428%:%
%:%3334=1429%:%
%:%3335=1429%:%
%:%3336=1430%:%
%:%3337=1430%:%
%:%3338=1431%:%
%:%3339=1431%:%
%:%3340=1432%:%
%:%3341=1432%:%
%:%3342=1433%:%
%:%3343=1433%:%
%:%3344=1434%:%
%:%3345=1434%:%
%:%3346=1435%:%
%:%3347=1436%:%
%:%3348=1436%:%
%:%3349=1437%:%
%:%3350=1438%:%
%:%3351=1438%:%
%:%3352=1439%:%
%:%3353=1440%:%
%:%3354=1440%:%
%:%3355=1441%:%
%:%3356=1441%:%
%:%3357=1442%:%
%:%3358=1442%:%
%:%3359=1443%:%
%:%3360=1444%:%
%:%3361=1444%:%
%:%3362=1445%:%
%:%3363=1446%:%
%:%3364=1446%:%
%:%3365=1447%:%
%:%3366=1447%:%
%:%3367=1448%:%
%:%3368=1448%:%
%:%3369=1449%:%
%:%3370=1449%:%
%:%3371=1450%:%
%:%3372=1451%:%
%:%3373=1451%:%
%:%3374=1452%:%
%:%3375=1453%:%
%:%3376=1453%:%
%:%3377=1454%:%
%:%3378=1454%:%
%:%3379=1455%:%
%:%3380=1455%:%
%:%3381=1456%:%
%:%3382=1457%:%
%:%3383=1457%:%
%:%3384=1458%:%
%:%3385=1458%:%
%:%3386=1459%:%
%:%3387=1459%:%
%:%3388=1460%:%
%:%3389=1460%:%
%:%3390=1461%:%
%:%3391=1461%:%
%:%3392=1462%:%
%:%3393=1462%:%
%:%3394=1463%:%
%:%3395=1463%:%
%:%3396=1464%:%
%:%3397=1464%:%
%:%3398=1465%:%
%:%3399=1465%:%
%:%3400=1466%:%
%:%3401=1466%:%
%:%3402=1467%:%
%:%3403=1467%:%
%:%3404=1468%:%
%:%3405=1468%:%
%:%3406=1469%:%
%:%3407=1470%:%
%:%3408=1470%:%
%:%3409=1471%:%
%:%3410=1471%:%
%:%3411=1472%:%
%:%3412=1472%:%
%:%3413=1473%:%
%:%3414=1473%:%
%:%3415=1473%:%
%:%3416=1474%:%
%:%3417=1474%:%
%:%3418=1475%:%
%:%3419=1475%:%
%:%3420=1476%:%
%:%3421=1476%:%
%:%3422=1477%:%
%:%3423=1477%:%
%:%3424=1478%:%
%:%3425=1478%:%
%:%3426=1479%:%
%:%3427=1479%:%
%:%3428=1480%:%
%:%3429=1480%:%
%:%3430=1481%:%
%:%3431=1481%:%
%:%3432=1482%:%
%:%3433=1482%:%
%:%3434=1483%:%
%:%3435=1483%:%
%:%3436=1484%:%
%:%3437=1484%:%
%:%3438=1485%:%
%:%3439=1485%:%
%:%3440=1486%:%
%:%3441=1487%:%
%:%3442=1487%:%
%:%3443=1488%:%
%:%3444=1488%:%
%:%3445=1489%:%
%:%3446=1489%:%
%:%3447=1490%:%
%:%3448=1490%:%
%:%3449=1491%:%
%:%3450=1491%:%
%:%3451=1492%:%
%:%3452=1492%:%
%:%3453=1493%:%
%:%3454=1493%:%
%:%3455=1494%:%
%:%3456=1494%:%
%:%3457=1495%:%
%:%3458=1495%:%
%:%3459=1496%:%
%:%3460=1496%:%
%:%3461=1497%:%
%:%3462=1497%:%
%:%3463=1498%:%
%:%3464=1498%:%
%:%3465=1499%:%
%:%3466=1499%:%
%:%3467=1500%:%
%:%3468=1500%:%
%:%3469=1501%:%
%:%3470=1501%:%
%:%3471=1502%:%
%:%3472=1502%:%
%:%3473=1503%:%
%:%3474=1504%:%
%:%3475=1505%:%
%:%3476=1505%:%
%:%3477=1506%:%
%:%3478=1506%:%
%:%3479=1507%:%
%:%3480=1507%:%
%:%3481=1508%:%
%:%3482=1508%:%
%:%3483=1509%:%
%:%3484=1509%:%
%:%3485=1510%:%
%:%3486=1510%:%
%:%3487=1511%:%
%:%3493=1511%:%
%:%3496=1512%:%
%:%3497=1513%:%
%:%3498=1513%:%
%:%3499=1514%:%
%:%3500=1515%:%
%:%3503=1516%:%
%:%3507=1516%:%
%:%3508=1516%:%
%:%3509=1517%:%
%:%3510=1517%:%
%:%3511=1518%:%
%:%3512=1518%:%
%:%3513=1519%:%
%:%3514=1519%:%
%:%3515=1520%:%
%:%3516=1520%:%
%:%3517=1521%:%
%:%3518=1521%:%
%:%3519=1522%:%
%:%3520=1522%:%
%:%3521=1523%:%
%:%3522=1524%:%
%:%3523=1524%:%
%:%3524=1525%:%
%:%3525=1525%:%
%:%3526=1526%:%
%:%3527=1527%:%
%:%3528=1527%:%
%:%3529=1528%:%
%:%3530=1529%:%
%:%3531=1529%:%
%:%3532=1530%:%
%:%3533=1530%:%
%:%3534=1531%:%
%:%3535=1531%:%
%:%3536=1531%:%
%:%3537=1532%:%
%:%3538=1532%:%
%:%3539=1533%:%
%:%3540=1533%:%
%:%3541=1534%:%
%:%3542=1534%:%
%:%3543=1535%:%
%:%3544=1535%:%
%:%3545=1535%:%
%:%3546=1536%:%
%:%3547=1536%:%
%:%3548=1537%:%
%:%3549=1537%:%
%:%3550=1538%:%
%:%3551=1538%:%
%:%3552=1539%:%
%:%3553=1539%:%
%:%3554=1540%:%
%:%3555=1540%:%
%:%3556=1541%:%
%:%3557=1541%:%
%:%3558=1542%:%
%:%3559=1542%:%
%:%3560=1543%:%
%:%3561=1543%:%
%:%3562=1544%:%
%:%3563=1544%:%
%:%3564=1545%:%
%:%3565=1545%:%
%:%3566=1546%:%
%:%3567=1546%:%
%:%3568=1547%:%
%:%3569=1547%:%
%:%3570=1548%:%
%:%3571=1548%:%
%:%3572=1549%:%
%:%3573=1550%:%
%:%3574=1550%:%
%:%3575=1551%:%
%:%3576=1551%:%
%:%3577=1552%:%
%:%3578=1553%:%
%:%3579=1553%:%
%:%3580=1554%:%
%:%3581=1554%:%
%:%3582=1555%:%
%:%3583=1555%:%
%:%3584=1556%:%
%:%3585=1556%:%
%:%3586=1557%:%
%:%3587=1557%:%
%:%3588=1558%:%
%:%3589=1558%:%
%:%3590=1559%:%
%:%3591=1559%:%
%:%3592=1560%:%
%:%3593=1560%:%
%:%3594=1560%:%
%:%3595=1561%:%
%:%3596=1562%:%
%:%3597=1563%:%
%:%3598=1563%:%
%:%3599=1564%:%
%:%3600=1564%:%
%:%3601=1564%:%
%:%3602=1565%:%
%:%3603=1565%:%
%:%3604=1566%:%
%:%3605=1566%:%
%:%3606=1567%:%
%:%3607=1567%:%
%:%3608=1568%:%
%:%3609=1568%:%
%:%3610=1569%:%
%:%3611=1569%:%
%:%3612=1570%:%
%:%3613=1570%:%
%:%3614=1571%:%
%:%3615=1571%:%
%:%3616=1572%:%
%:%3617=1572%:%
%:%3618=1573%:%
%:%3619=1573%:%
%:%3620=1574%:%
%:%3621=1574%:%
%:%3622=1575%:%
%:%3623=1575%:%
%:%3624=1576%:%
%:%3625=1576%:%
%:%3626=1577%:%
%:%3627=1577%:%
%:%3628=1578%:%
%:%3629=1578%:%
%:%3630=1579%:%
%:%3631=1579%:%
%:%3632=1580%:%
%:%3633=1580%:%
%:%3634=1581%:%
%:%3635=1581%:%
%:%3636=1582%:%
%:%3637=1583%:%
%:%3638=1583%:%
%:%3639=1584%:%
%:%3640=1584%:%
%:%3641=1584%:%
%:%3642=1585%:%
%:%3643=1586%:%
%:%3644=1586%:%
%:%3645=1587%:%
%:%3646=1587%:%
%:%3647=1588%:%
%:%3648=1588%:%
%:%3649=1589%:%
%:%3650=1589%:%
%:%3651=1590%:%
%:%3652=1591%:%
%:%3653=1591%:%
%:%3654=1592%:%
%:%3655=1592%:%
%:%3656=1593%:%
%:%3657=1593%:%
%:%3658=1594%:%
%:%3659=1594%:%
%:%3660=1595%:%
%:%3661=1595%:%
%:%3662=1596%:%
%:%3663=1596%:%
%:%3664=1597%:%
%:%3665=1597%:%
%:%3666=1598%:%
%:%3667=1598%:%
%:%3668=1599%:%
%:%3669=1600%:%
%:%3670=1600%:%
%:%3671=1601%:%
%:%3672=1601%:%
%:%3673=1602%:%
%:%3674=1602%:%
%:%3675=1603%:%
%:%3676=1603%:%
%:%3677=1604%:%
%:%3678=1604%:%
%:%3679=1605%:%
%:%3680=1605%:%
%:%3681=1606%:%
%:%3682=1606%:%
%:%3683=1607%:%
%:%3684=1607%:%
%:%3685=1608%:%
%:%3686=1609%:%
%:%3687=1609%:%
%:%3688=1610%:%
%:%3689=1610%:%
%:%3690=1611%:%
%:%3691=1611%:%
%:%3692=1612%:%
%:%3693=1613%:%
%:%3694=1613%:%
%:%3695=1614%:%
%:%3696=1614%:%
%:%3697=1615%:%
%:%3698=1615%:%
%:%3699=1616%:%
%:%3700=1616%:%
%:%3701=1617%:%
%:%3702=1617%:%
%:%3703=1618%:%
%:%3704=1618%:%
%:%3705=1619%:%
%:%3706=1620%:%
%:%3707=1620%:%
%:%3708=1621%:%
%:%3709=1621%:%
%:%3710=1622%:%
%:%3711=1622%:%
%:%3712=1623%:%
%:%3713=1623%:%
%:%3714=1624%:%
%:%3715=1624%:%
%:%3716=1625%:%
%:%3717=1626%:%
%:%3718=1626%:%
%:%3719=1626%:%
%:%3720=1627%:%
%:%3721=1628%:%
%:%3722=1628%:%
%:%3723=1629%:%
%:%3724=1629%:%
%:%3725=1630%:%
%:%3726=1630%:%
%:%3727=1631%:%
%:%3728=1631%:%
%:%3729=1632%:%
%:%3730=1632%:%
%:%3731=1633%:%
%:%3732=1633%:%
%:%3733=1634%:%
%:%3734=1634%:%
%:%3735=1635%:%
%:%3736=1635%:%
%:%3737=1636%:%
%:%3738=1636%:%
%:%3739=1637%:%
%:%3740=1637%:%
%:%3741=1638%:%
%:%3742=1638%:%
%:%3743=1639%:%
%:%3744=1639%:%
%:%3745=1640%:%
%:%3746=1640%:%
%:%3747=1641%:%
%:%3748=1641%:%
%:%3749=1642%:%
%:%3750=1642%:%
%:%3751=1643%:%
%:%3752=1643%:%
%:%3753=1644%:%
%:%3754=1644%:%
%:%3755=1645%:%
%:%3756=1645%:%
%:%3757=1646%:%
%:%3758=1647%:%
%:%3759=1647%:%
%:%3760=1648%:%
%:%3761=1648%:%
%:%3762=1649%:%
%:%3763=1649%:%
%:%3764=1650%:%
%:%3765=1650%:%
%:%3766=1651%:%
%:%3767=1651%:%
%:%3768=1652%:%
%:%3769=1653%:%
%:%3770=1653%:%
%:%3771=1654%:%
%:%3772=1655%:%
%:%3773=1655%:%
%:%3774=1656%:%
%:%3775=1656%:%
%:%3776=1657%:%
%:%3777=1658%:%
%:%3778=1658%:%
%:%3779=1659%:%
%:%3780=1659%:%
%:%3781=1659%:%
%:%3782=1660%:%
%:%3783=1660%:%
%:%3784=1661%:%
%:%3785=1661%:%
%:%3786=1662%:%
%:%3787=1663%:%
%:%3788=1663%:%
%:%3789=1664%:%
%:%3790=1664%:%
%:%3791=1665%:%
%:%3792=1665%:%
%:%3793=1666%:%
%:%3794=1666%:%
%:%3795=1667%:%
%:%3796=1667%:%
%:%3797=1667%:%
%:%3798=1668%:%
%:%3799=1668%:%
%:%3800=1669%:%
%:%3801=1669%:%
%:%3802=1670%:%
%:%3803=1670%:%
%:%3804=1670%:%
%:%3805=1671%:%
%:%3806=1671%:%
%:%3807=1672%:%
%:%3808=1672%:%
%:%3809=1673%:%
%:%3810=1673%:%
%:%3811=1674%:%
%:%3812=1674%:%
%:%3813=1675%:%
%:%3814=1675%:%
%:%3815=1676%:%
%:%3816=1676%:%
%:%3817=1677%:%
%:%3818=1677%:%
%:%3819=1678%:%
%:%3820=1678%:%
%:%3821=1679%:%
%:%3822=1680%:%
%:%3823=1680%:%
%:%3824=1681%:%
%:%3825=1681%:%
%:%3826=1682%:%
%:%3827=1682%:%
%:%3828=1683%:%
%:%3829=1683%:%
%:%3830=1684%:%
%:%3831=1684%:%
%:%3832=1684%:%
%:%3833=1685%:%
%:%3834=1685%:%
%:%3835=1686%:%
%:%3836=1686%:%
%:%3837=1686%:%
%:%3838=1687%:%
%:%3839=1688%:%
%:%3840=1688%:%
%:%3841=1689%:%
%:%3842=1689%:%
%:%3843=1690%:%
%:%3844=1690%:%
%:%3845=1691%:%
%:%3846=1691%:%
%:%3847=1692%:%
%:%3848=1692%:%
%:%3849=1693%:%
%:%3850=1693%:%
%:%3851=1694%:%
%:%3852=1694%:%
%:%3853=1695%:%
%:%3854=1695%:%
%:%3855=1696%:%
%:%3856=1696%:%
%:%3857=1697%:%
%:%3858=1697%:%
%:%3859=1697%:%
%:%3860=1698%:%
%:%3861=1699%:%
%:%3862=1699%:%
%:%3863=1700%:%
%:%3864=1700%:%
%:%3865=1701%:%
%:%3866=1702%:%
%:%3867=1702%:%
%:%3868=1703%:%
%:%3869=1703%:%
%:%3870=1704%:%
%:%3871=1705%:%
%:%3872=1705%:%
%:%3873=1706%:%
%:%3874=1706%:%
%:%3875=1707%:%
%:%3876=1707%:%
%:%3877=1708%:%
%:%3878=1708%:%
%:%3879=1709%:%
%:%3880=1709%:%
%:%3881=1710%:%
%:%3882=1710%:%
%:%3884=1712%:%
%:%3885=1713%:%
%:%3886=1713%:%
%:%3887=1714%:%
%:%3888=1714%:%
%:%3889=1715%:%
%:%3890=1716%:%
%:%3891=1716%:%
%:%3892=1717%:%
%:%3893=1718%:%
%:%3894=1718%:%
%:%3895=1719%:%
%:%3896=1719%:%
%:%3897=1720%:%
%:%3898=1720%:%
%:%3899=1721%:%
%:%3900=1721%:%
%:%3901=1722%:%
%:%3902=1722%:%
%:%3903=1723%:%
%:%3904=1723%:%
%:%3905=1724%:%
%:%3906=1724%:%
%:%3907=1725%:%
%:%3908=1725%:%
%:%3909=1726%:%
%:%3910=1726%:%
%:%3911=1727%:%
%:%3912=1727%:%
%:%3913=1728%:%
%:%3914=1729%:%
%:%3915=1730%:%
%:%3916=1731%:%
%:%3917=1731%:%
%:%3918=1732%:%
%:%3919=1732%:%
%:%3920=1733%:%
%:%3921=1733%:%
%:%3922=1734%:%
%:%3923=1734%:%
%:%3924=1735%:%
%:%3925=1735%:%
%:%3926=1736%:%
%:%3927=1736%:%
%:%3928=1737%:%
%:%3929=1737%:%
%:%3930=1738%:%
%:%3931=1739%:%
%:%3932=1739%:%
%:%3933=1740%:%
%:%3934=1740%:%
%:%3935=1741%:%
%:%3936=1741%:%
%:%3937=1741%:%
%:%3938=1742%:%
%:%3939=1743%:%
%:%3940=1744%:%
%:%3941=1744%:%
%:%3942=1745%:%
%:%3943=1745%:%
%:%3944=1746%:%
%:%3945=1746%:%
%:%3946=1746%:%
%:%3947=1747%:%
%:%3948=1747%:%
%:%3949=1748%:%
%:%3950=1748%:%
%:%3951=1749%:%
%:%3952=1750%:%
%:%3953=1750%:%
%:%3954=1751%:%
%:%3955=1751%:%
%:%3956=1752%:%
%:%3957=1752%:%
%:%3958=1753%:%
%:%3959=1753%:%
%:%3960=1754%:%
%:%3961=1754%:%
%:%3962=1755%:%
%:%3963=1755%:%
%:%3964=1755%:%
%:%3965=1756%:%
%:%3966=1756%:%
%:%3967=1757%:%
%:%3968=1757%:%
%:%3969=1758%:%
%:%3970=1758%:%
%:%3971=1759%:%
%:%3972=1759%:%
%:%3973=1760%:%
%:%3974=1760%:%
%:%3975=1761%:%
%:%3976=1761%:%
%:%3977=1762%:%
%:%3978=1762%:%
%:%3979=1763%:%
%:%3980=1763%:%
%:%3981=1764%:%
%:%3982=1765%:%
%:%3983=1765%:%
%:%3984=1766%:%
%:%3985=1766%:%
%:%3986=1767%:%
%:%3987=1767%:%
%:%3988=1768%:%
%:%3989=1768%:%
%:%3990=1768%:%
%:%3991=1769%:%
%:%3992=1769%:%
%:%3993=1770%:%
%:%3994=1770%:%
%:%3995=1771%:%
%:%3996=1771%:%
%:%3997=1772%:%
%:%3998=1772%:%
%:%3999=1773%:%
%:%4000=1773%:%
%:%4001=1774%:%
%:%4002=1774%:%
%:%4003=1775%:%
%:%4004=1775%:%
%:%4005=1776%:%
%:%4006=1776%:%
%:%4007=1777%:%
%:%4008=1778%:%
%:%4009=1778%:%
%:%4010=1779%:%
%:%4011=1779%:%
%:%4012=1780%:%
%:%4013=1780%:%
%:%4014=1781%:%
%:%4015=1781%:%
%:%4016=1782%:%
%:%4017=1782%:%
%:%4018=1783%:%
%:%4019=1783%:%
%:%4020=1784%:%
%:%4021=1784%:%
%:%4022=1784%:%
%:%4023=1785%:%
%:%4024=1785%:%
%:%4025=1786%:%
%:%4026=1786%:%
%:%4027=1787%:%
%:%4028=1787%:%
%:%4029=1787%:%
%:%4030=1788%:%
%:%4031=1789%:%
%:%4032=1789%:%
%:%4033=1790%:%
%:%4034=1790%:%
%:%4035=1791%:%
%:%4036=1791%:%
%:%4037=1792%:%
%:%4038=1792%:%
%:%4039=1793%:%
%:%4040=1793%:%
%:%4041=1794%:%
%:%4042=1794%:%
%:%4043=1794%:%
%:%4044=1795%:%
%:%4045=1795%:%
%:%4046=1796%:%
%:%4047=1796%:%
%:%4048=1797%:%
%:%4049=1797%:%
%:%4050=1798%:%
%:%4051=1798%:%
%:%4052=1799%:%
%:%4053=1799%:%
%:%4054=1800%:%
%:%4055=1800%:%
%:%4056=1801%:%
%:%4057=1801%:%
%:%4058=1802%:%
%:%4059=1802%:%
%:%4060=1803%:%
%:%4061=1803%:%
%:%4062=1804%:%
%:%4063=1804%:%
%:%4064=1805%:%
%:%4065=1805%:%
%:%4066=1806%:%
%:%4067=1806%:%
%:%4068=1807%:%
%:%4069=1807%:%
%:%4070=1808%:%
%:%4071=1808%:%
%:%4072=1809%:%
%:%4073=1809%:%
%:%4074=1810%:%
%:%4075=1810%:%
%:%4076=1811%:%
%:%4077=1811%:%
%:%4078=1812%:%
%:%4079=1812%:%
%:%4080=1813%:%
%:%4081=1813%:%
%:%4082=1813%:%
%:%4083=1814%:%
%:%4084=1814%:%
%:%4085=1815%:%
%:%4086=1815%:%
%:%4087=1816%:%
%:%4088=1816%:%
%:%4089=1817%:%
%:%4090=1817%:%
%:%4091=1818%:%
%:%4092=1818%:%
%:%4093=1819%:%
%:%4094=1819%:%
%:%4095=1820%:%
%:%4096=1820%:%
%:%4097=1821%:%
%:%4098=1822%:%
%:%4099=1822%:%
%:%4100=1823%:%
%:%4101=1823%:%
%:%4102=1824%:%
%:%4103=1824%:%
%:%4104=1825%:%
%:%4105=1825%:%
%:%4106=1826%:%
%:%4107=1826%:%
%:%4108=1827%:%
%:%4109=1827%:%
%:%4110=1828%:%
%:%4111=1828%:%
%:%4112=1829%:%
%:%4113=1829%:%
%:%4114=1830%:%
%:%4115=1830%:%
%:%4116=1831%:%
%:%4117=1831%:%
%:%4118=1831%:%
%:%4119=1832%:%
%:%4120=1832%:%
%:%4121=1833%:%
%:%4122=1833%:%
%:%4123=1834%:%
%:%4124=1834%:%
%:%4125=1834%:%
%:%4126=1835%:%
%:%4127=1835%:%
%:%4128=1836%:%
%:%4129=1836%:%
%:%4130=1837%:%
%:%4131=1837%:%
%:%4132=1838%:%
%:%4133=1838%:%
%:%4134=1839%:%
%:%4135=1839%:%
%:%4136=1840%:%
%:%4137=1840%:%
%:%4138=1841%:%
%:%4139=1841%:%
%:%4140=1842%:%
%:%4141=1842%:%
%:%4142=1843%:%
%:%4143=1843%:%
%:%4144=1844%:%
%:%4145=1844%:%
%:%4146=1845%:%
%:%4147=1845%:%
%:%4148=1846%:%
%:%4149=1846%:%
%:%4150=1847%:%
%:%4151=1847%:%
%:%4152=1848%:%
%:%4153=1848%:%
%:%4154=1849%:%
%:%4155=1849%:%
%:%4156=1850%:%
%:%4157=1850%:%
%:%4158=1851%:%
%:%4159=1851%:%
%:%4160=1852%:%
%:%4161=1852%:%
%:%4162=1853%:%
%:%4163=1853%:%
%:%4164=1854%:%
%:%4165=1854%:%
%:%4166=1855%:%
%:%4167=1855%:%
%:%4168=1856%:%
%:%4169=1856%:%
%:%4170=1857%:%
%:%4171=1857%:%
%:%4172=1858%:%
%:%4173=1858%:%
%:%4174=1859%:%
%:%4175=1859%:%
%:%4176=1860%:%
%:%4177=1860%:%
%:%4178=1861%:%
%:%4179=1861%:%
%:%4180=1862%:%
%:%4181=1862%:%
%:%4182=1862%:%
%:%4183=1863%:%
%:%4184=1863%:%
%:%4185=1864%:%
%:%4186=1864%:%
%:%4187=1865%:%
%:%4188=1865%:%
%:%4189=1866%:%
%:%4190=1866%:%
%:%4191=1867%:%
%:%4192=1867%:%
%:%4193=1868%:%
%:%4194=1868%:%
%:%4195=1868%:%
%:%4196=1869%:%
%:%4197=1869%:%
%:%4198=1870%:%
%:%4199=1870%:%
%:%4200=1871%:%
%:%4201=1871%:%
%:%4202=1872%:%
%:%4203=1872%:%
%:%4204=1873%:%
%:%4205=1873%:%
%:%4206=1874%:%
%:%4207=1874%:%
%:%4208=1875%:%
%:%4209=1875%:%
%:%4210=1876%:%
%:%4211=1876%:%
%:%4212=1877%:%
%:%4213=1877%:%
%:%4214=1878%:%
%:%4215=1878%:%
%:%4216=1879%:%
%:%4217=1880%:%
%:%4218=1880%:%
%:%4219=1881%:%
%:%4220=1881%:%
%:%4221=1882%:%
%:%4222=1882%:%
%:%4223=1883%:%
%:%4224=1883%:%
%:%4225=1884%:%
%:%4226=1884%:%
%:%4227=1885%:%
%:%4228=1885%:%
%:%4229=1886%:%
%:%4230=1886%:%
%:%4231=1887%:%
%:%4232=1887%:%
%:%4233=1888%:%
%:%4234=1888%:%
%:%4235=1889%:%
%:%4236=1889%:%
%:%4237=1889%:%
%:%4238=1890%:%
%:%4239=1890%:%
%:%4240=1891%:%
%:%4241=1891%:%
%:%4242=1892%:%
%:%4243=1892%:%
%:%4244=1892%:%
%:%4245=1893%:%
%:%4246=1893%:%
%:%4247=1894%:%
%:%4248=1894%:%
%:%4249=1895%:%
%:%4250=1895%:%
%:%4251=1896%:%
%:%4252=1896%:%
%:%4253=1897%:%
%:%4254=1897%:%
%:%4255=1898%:%
%:%4256=1898%:%
%:%4257=1899%:%
%:%4258=1899%:%
%:%4259=1900%:%
%:%4260=1900%:%
%:%4261=1900%:%
%:%4262=1901%:%
%:%4263=1901%:%
%:%4264=1902%:%
%:%4265=1902%:%
%:%4266=1903%:%
%:%4267=1903%:%
%:%4268=1904%:%
%:%4269=1904%:%
%:%4270=1905%:%
%:%4271=1905%:%
%:%4272=1906%:%
%:%4273=1906%:%
%:%4274=1907%:%
%:%4275=1907%:%
%:%4276=1908%:%
%:%4277=1908%:%
%:%4278=1909%:%
%:%4279=1909%:%
%:%4280=1910%:%
%:%4281=1910%:%
%:%4282=1911%:%
%:%4283=1911%:%
%:%4284=1912%:%
%:%4285=1912%:%
%:%4286=1913%:%
%:%4287=1913%:%
%:%4288=1914%:%
%:%4289=1914%:%
%:%4290=1915%:%
%:%4291=1915%:%
%:%4292=1916%:%
%:%4293=1916%:%
%:%4294=1917%:%
%:%4295=1917%:%
%:%4296=1918%:%
%:%4297=1918%:%
%:%4298=1919%:%
%:%4299=1919%:%
%:%4300=1919%:%
%:%4301=1920%:%
%:%4302=1920%:%
%:%4303=1921%:%
%:%4304=1921%:%
%:%4305=1922%:%
%:%4306=1922%:%
%:%4307=1923%:%
%:%4308=1923%:%
%:%4309=1923%:%
%:%4310=1924%:%
%:%4311=1924%:%
%:%4312=1925%:%
%:%4313=1925%:%
%:%4314=1926%:%
%:%4315=1926%:%
%:%4316=1927%:%
%:%4317=1927%:%
%:%4318=1928%:%
%:%4319=1928%:%
%:%4320=1929%:%
%:%4321=1929%:%
%:%4322=1930%:%
%:%4323=1930%:%
%:%4324=1931%:%
%:%4325=1931%:%
%:%4326=1932%:%
%:%4327=1932%:%
%:%4328=1933%:%
%:%4329=1933%:%
%:%4330=1934%:%
%:%4331=1934%:%
%:%4332=1935%:%
%:%4333=1935%:%
%:%4334=1936%:%
%:%4335=1936%:%
%:%4336=1936%:%
%:%4337=1937%:%
%:%4338=1937%:%
%:%4339=1938%:%
%:%4340=1938%:%
%:%4341=1939%:%
%:%4342=1939%:%
%:%4343=1940%:%
%:%4344=1940%:%
%:%4345=1941%:%
%:%4346=1941%:%
%:%4347=1942%:%
%:%4348=1942%:%
%:%4349=1943%:%
%:%4350=1943%:%
%:%4351=1944%:%
%:%4352=1944%:%
%:%4353=1945%:%
%:%4354=1945%:%
%:%4355=1945%:%
%:%4356=1946%:%
%:%4357=1946%:%
%:%4358=1947%:%
%:%4359=1947%:%
%:%4360=1948%:%
%:%4361=1948%:%
%:%4362=1948%:%
%:%4363=1949%:%
%:%4364=1949%:%
%:%4365=1950%:%
%:%4366=1950%:%
%:%4367=1951%:%
%:%4368=1952%:%
%:%4369=1952%:%
%:%4370=1953%:%
%:%4371=1954%:%
%:%4372=1954%:%
%:%4373=1955%:%
%:%4374=1955%:%
%:%4375=1956%:%
%:%4376=1957%:%
%:%4377=1957%:%
%:%4378=1958%:%
%:%4379=1959%:%
%:%4380=1959%:%
%:%4381=1960%:%
%:%4382=1961%:%
%:%4383=1961%:%
%:%4384=1962%:%
%:%4385=1962%:%
%:%4386=1963%:%
%:%4387=1963%:%
%:%4388=1964%:%
%:%4389=1964%:%
%:%4390=1964%:%
%:%4391=1965%:%
%:%4392=1965%:%
%:%4393=1966%:%
%:%4394=1966%:%
%:%4395=1967%:%
%:%4396=1968%:%
%:%4397=1968%:%
%:%4398=1969%:%
%:%4399=1969%:%
%:%4400=1970%:%
%:%4401=1970%:%
%:%4402=1971%:%
%:%4403=1971%:%
%:%4404=1972%:%
%:%4405=1972%:%
%:%4406=1972%:%
%:%4407=1973%:%
%:%4408=1973%:%
%:%4409=1974%:%
%:%4410=1974%:%
%:%4411=1975%:%
%:%4412=1975%:%
%:%4413=1976%:%
%:%4414=1976%:%
%:%4415=1977%:%
%:%4416=1977%:%
%:%4417=1978%:%
%:%4418=1978%:%
%:%4419=1979%:%
%:%4420=1979%:%
%:%4421=1980%:%
%:%4422=1980%:%
%:%4423=1980%:%
%:%4424=1981%:%
%:%4425=1981%:%
%:%4426=1982%:%
%:%4427=1982%:%
%:%4428=1983%:%
%:%4429=1983%:%
%:%4430=1984%:%
%:%4431=1984%:%
%:%4432=1985%:%
%:%4433=1985%:%
%:%4434=1985%:%
%:%4435=1986%:%
%:%4436=1986%:%
%:%4437=1987%:%
%:%4438=1987%:%
%:%4439=1988%:%
%:%4440=1988%:%
%:%4441=1988%:%
%:%4442=1989%:%
%:%4443=1989%:%
%:%4444=1990%:%
%:%4445=1990%:%
%:%4446=1991%:%
%:%4447=1991%:%
%:%4448=1992%:%
%:%4449=1992%:%
%:%4450=1993%:%
%:%4451=1993%:%
%:%4452=1994%:%
%:%4453=1994%:%
%:%4454=1995%:%
%:%4455=1995%:%
%:%4456=1996%:%
%:%4457=1996%:%
%:%4458=1997%:%
%:%4459=1997%:%
%:%4460=1998%:%
%:%4461=1998%:%
%:%4462=1999%:%
%:%4463=1999%:%
%:%4464=2000%:%
%:%4465=2000%:%
%:%4466=2001%:%
%:%4481=2003%:%
%:%4491=2005%:%
%:%4492=2005%:%
%:%4493=2006%:%
%:%4494=2007%:%
%:%4501=2008%:%
%:%4502=2008%:%
%:%4503=2009%:%
%:%4504=2009%:%
%:%4505=2010%:%
%:%4506=2010%:%
%:%4507=2011%:%
%:%4508=2011%:%
%:%4509=2012%:%
%:%4510=2012%:%
%:%4511=2013%:%
%:%4512=2013%:%
%:%4513=2014%:%
%:%4514=2014%:%
%:%4515=2015%:%
%:%4516=2015%:%
%:%4517=2016%:%
%:%4518=2016%:%
%:%4519=2017%:%
%:%4520=2017%:%
%:%4521=2018%:%
%:%4522=2018%:%
%:%4523=2019%:%
%:%4524=2019%:%
%:%4525=2020%:%
%:%4526=2020%:%
%:%4527=2021%:%
%:%4528=2021%:%
%:%4529=2022%:%
%:%4535=2022%:%
%:%4540=2023%:%
%:%4545=2024%:%